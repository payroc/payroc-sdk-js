// This file was auto-generated by Fern from our API Definition.

import type { BaseClientOptions, BaseRequestOptions } from "../../../../../../BaseClient.js";
import { type NormalizedClientOptionsWithAuth, normalizeClientOptionsWithAuth } from "../../../../../../BaseClient.js";
import { mergeHeaders } from "../../../../../../core/headers.js";
import * as core from "../../../../../../core/index.js";
import * as environments from "../../../../../../environments.js";
import { handleNonStatusCodeError } from "../../../../../../errors/handleNonStatusCodeError.js";
import * as errors from "../../../../../../errors/index.js";
import * as Payroc from "../../../../../index.js";

export declare namespace SettlementClient {
    export type Options = BaseClientOptions;

    export interface RequestOptions extends BaseRequestOptions {}
}

export class SettlementClient {
    protected readonly _options: NormalizedClientOptionsWithAuth<SettlementClient.Options>;

    constructor(options: SettlementClient.Options) {
        this._options = normalizeClientOptionsWithAuth(options);
    }

    /**
     * Use this method to return a [paginated](https://docs.payroc.com/api/pagination) list of batches that your merchants submitted to the processor on a specific date.
     *
     * **Note:** If you want to view the details of a specific batch and you have its batchId, use our [Retrieve Batch](https://docs.payroc.com/api/schema/reporting/settlement/retrieve-batch) method.
     *
     * Use query parameters to filter the list of results that we return, for example, to search for batches that were submitted by a specific merchant.
     *
     * > **Important:** You must provide a value for the date query parameter.
     *
     * Our gateway returns the following information about each batch in the list:
     * -	Transaction information, including the number of transactions and total value of sales.
     * -	Merchant information, including the merchant ID (MID) and the processing account that the batch is associated with.
     *
     * @param {Payroc.reporting.ListReportingSettlementBatchesRequest} request
     * @param {SettlementClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link Payroc.BadRequestError}
     * @throws {@link Payroc.UnauthorizedError}
     * @throws {@link Payroc.ForbiddenError}
     * @throws {@link Payroc.NotAcceptableError}
     * @throws {@link Payroc.InternalServerError}
     *
     * @example
     *     await client.reporting.settlement.listBatches({
     *         before: "2571",
     *         after: "8516",
     *         limit: 1,
     *         date: "2027-07-02",
     *         merchantId: "4525644354"
     *     })
     */
    public async listBatches(
        request: Payroc.reporting.ListReportingSettlementBatchesRequest,
        requestOptions?: SettlementClient.RequestOptions,
    ): Promise<core.PayrocPager<Payroc.Batch, Payroc.reporting.ListBatchesSettlementResponse>> {
        const { before, after, limit, date, merchantId } = request;
        const _queryParams: Record<string, string | string[] | object | object[] | null> = {};
        if (before != null) {
            _queryParams.before = before;
        }

        if (after != null) {
            _queryParams.after = after;
        }

        if (limit != null) {
            _queryParams.limit = limit.toString();
        }

        _queryParams.date = date;
        if (merchantId != null) {
            _queryParams.merchantId = merchantId;
        }

        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _request = {
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    ((await core.Supplier.get(this._options.environment)) ?? environments.PayrocEnvironment.Production)
                        .api,
                "batches",
            ),
            method: "GET",
            headers: _headers,
            queryParameters: { ..._queryParams, ...requestOptions?.queryParams },
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        };
        const _sendRequest = async (request: core.Fetcher.Args) => {
            const _response = await core.fetcher<Payroc.reporting.ListBatchesSettlementResponse>(request);
            if (_response.ok) {
                return _response;
            }
            if (_response.error.reason === "status-code") {
                switch (_response.error.statusCode) {
                    case 400:
                        throw new Payroc.BadRequestError(
                            _response.error.body as Payroc.FourHundred,
                            _response.rawResponse,
                        );
                    case 401:
                        throw new Payroc.UnauthorizedError(
                            _response.error.body as Payroc.FourHundredOne,
                            _response.rawResponse,
                        );
                    case 403:
                        throw new Payroc.ForbiddenError(_response.error.body as unknown, _response.rawResponse);
                    case 406:
                        throw new Payroc.NotAcceptableError(
                            _response.error.body as Payroc.FourHundredSix,
                            _response.rawResponse,
                        );
                    case 500:
                        throw new Payroc.InternalServerError(
                            _response.error.body as Payroc.FiveHundred,
                            _response.rawResponse,
                        );
                    default:
                        throw new errors.PayrocError({
                            statusCode: _response.error.statusCode,
                            body: _response.error.body,
                            rawResponse: _response.rawResponse,
                        });
                }
            }
            return handleNonStatusCodeError(_response.error, _response.rawResponse, "GET", "/batches");
        };
        return core.createPayrocPager<Payroc.Batch, Payroc.reporting.ListBatchesSettlementResponse>({
            sendRequest: _sendRequest,
            initialHttpRequest: _request,
            clientOptions: this._options,
            requestOptions: requestOptions,
        });
    }

    /**
     * Use this method to retrieve information about a batch.
     *
     * **Note:** To retrieve a batch, you need its batchId. If you don't have the batchId, use our [List Batches](https://docs.payroc.com/api/schema/reporting/settlement/list-batches) method to search for the batch.
     *
     * Our gateway returns the following information about the batch:
     *
     * -	Transaction information, including the number of transactions and total value of sales.
     * -	Merchant information, including the merchant ID (MID) and the processing account that the batch is associated with.
     *
     * @param {Payroc.reporting.RetrieveBatchSettlementRequest} request
     * @param {SettlementClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link Payroc.BadRequestError}
     * @throws {@link Payroc.UnauthorizedError}
     * @throws {@link Payroc.ForbiddenError}
     * @throws {@link Payroc.NotFoundError}
     * @throws {@link Payroc.NotAcceptableError}
     * @throws {@link Payroc.InternalServerError}
     *
     * @example
     *     await client.reporting.settlement.retrieveBatch({
     *         batchId: 1
     *     })
     */
    public retrieveBatch(
        request: Payroc.reporting.RetrieveBatchSettlementRequest,
        requestOptions?: SettlementClient.RequestOptions,
    ): core.HttpResponsePromise<Payroc.Batch> {
        return core.HttpResponsePromise.fromPromise(this.__retrieveBatch(request, requestOptions));
    }

    private async __retrieveBatch(
        request: Payroc.reporting.RetrieveBatchSettlementRequest,
        requestOptions?: SettlementClient.RequestOptions,
    ): Promise<core.WithRawResponse<Payroc.Batch>> {
        const { batchId } = request;
        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _response = await (this._options.fetcher ?? core.fetcher)({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    ((await core.Supplier.get(this._options.environment)) ?? environments.PayrocEnvironment.Production)
                        .api,
                `batches/${core.url.encodePathParam(batchId)}`,
            ),
            method: "GET",
            headers: _headers,
            queryParameters: requestOptions?.queryParams,
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        });
        if (_response.ok) {
            return { data: _response.body as Payroc.Batch, rawResponse: _response.rawResponse };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new Payroc.BadRequestError(_response.error.body as Payroc.FourHundred, _response.rawResponse);
                case 401:
                    throw new Payroc.UnauthorizedError(
                        _response.error.body as Payroc.FourHundredOne,
                        _response.rawResponse,
                    );
                case 403:
                    throw new Payroc.ForbiddenError(_response.error.body as unknown, _response.rawResponse);
                case 404:
                    throw new Payroc.NotFoundError(
                        _response.error.body as Payroc.FourHundredFour,
                        _response.rawResponse,
                    );
                case 406:
                    throw new Payroc.NotAcceptableError(
                        _response.error.body as Payroc.FourHundredSix,
                        _response.rawResponse,
                    );
                case 500:
                    throw new Payroc.InternalServerError(
                        _response.error.body as Payroc.FiveHundred,
                        _response.rawResponse,
                    );
                default:
                    throw new errors.PayrocError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        return handleNonStatusCodeError(_response.error, _response.rawResponse, "GET", "/batches/{batchId}");
    }

    /**
     * Use this method to return a paginated list of your merchantsâ€™ transactions.
     *
     * **Note:** If you want to view the details of a specific transaction and you have its transactionId, use our [Retrieve Transaction](https://docs.payroc.com/api/schema/reporting/settlement/retrieve-transaction) method.
     *
     * Use query parameters to filter the list of results that we return, for example, to search for transactions for a specific merchant.
     *
     * > **Important:** You must provide a value for either the date query parameter or the batchId query parameter.
     *
     * Our gateway returns the following information about each transaction in the list:
     *
     * -	Merchant and processing account that ran the transaction.
     * -	Transaction type, date, amount, and the payment method that the customer used.
     * -	Batch that contains the transaction, and authorization details for the transaction.
     * -	Processor that settled the transaction and the ACH deposit containing the transaction.
     *
     * @param {Payroc.reporting.ListReportingSettlementTransactionsRequest} request
     * @param {SettlementClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link Payroc.BadRequestError}
     * @throws {@link Payroc.UnauthorizedError}
     * @throws {@link Payroc.ForbiddenError}
     * @throws {@link Payroc.NotAcceptableError}
     * @throws {@link Payroc.InternalServerError}
     *
     * @example
     *     await client.reporting.settlement.listTransactions({
     *         before: "2571",
     *         after: "8516",
     *         limit: 1,
     *         date: "2024-07-02",
     *         batchId: 1,
     *         merchantId: "4525644354",
     *         transactionType: "Capture"
     *     })
     */
    public async listTransactions(
        request: Payroc.reporting.ListReportingSettlementTransactionsRequest = {},
        requestOptions?: SettlementClient.RequestOptions,
    ): Promise<core.PayrocPager<Payroc.Transaction, Payroc.reporting.ListTransactionsSettlementResponse>> {
        const { before, after, limit, date, batchId, merchantId, transactionType } = request;
        const _queryParams: Record<string, string | string[] | object | object[] | null> = {};
        if (before != null) {
            _queryParams.before = before;
        }

        if (after != null) {
            _queryParams.after = after;
        }

        if (limit != null) {
            _queryParams.limit = limit.toString();
        }

        if (date != null) {
            _queryParams.date = date;
        }

        if (batchId != null) {
            _queryParams.batchId = batchId.toString();
        }

        if (merchantId != null) {
            _queryParams.merchantId = merchantId;
        }

        if (transactionType != null) {
            _queryParams.transactionType = transactionType;
        }

        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _request = {
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    ((await core.Supplier.get(this._options.environment)) ?? environments.PayrocEnvironment.Production)
                        .api,
                "transactions",
            ),
            method: "GET",
            headers: _headers,
            queryParameters: { ..._queryParams, ...requestOptions?.queryParams },
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        };
        const _sendRequest = async (request: core.Fetcher.Args) => {
            const _response = await core.fetcher<Payroc.reporting.ListTransactionsSettlementResponse>(request);
            if (_response.ok) {
                return _response;
            }
            if (_response.error.reason === "status-code") {
                switch (_response.error.statusCode) {
                    case 400:
                        throw new Payroc.BadRequestError(
                            _response.error.body as Payroc.FourHundred,
                            _response.rawResponse,
                        );
                    case 401:
                        throw new Payroc.UnauthorizedError(
                            _response.error.body as Payroc.FourHundredOne,
                            _response.rawResponse,
                        );
                    case 403:
                        throw new Payroc.ForbiddenError(_response.error.body as unknown, _response.rawResponse);
                    case 406:
                        throw new Payroc.NotAcceptableError(
                            _response.error.body as Payroc.FourHundredSix,
                            _response.rawResponse,
                        );
                    case 500:
                        throw new Payroc.InternalServerError(
                            _response.error.body as Payroc.FiveHundred,
                            _response.rawResponse,
                        );
                    default:
                        throw new errors.PayrocError({
                            statusCode: _response.error.statusCode,
                            body: _response.error.body,
                            rawResponse: _response.rawResponse,
                        });
                }
            }
            return handleNonStatusCodeError(_response.error, _response.rawResponse, "GET", "/transactions");
        };
        return core.createPayrocPager<Payroc.Transaction, Payroc.reporting.ListTransactionsSettlementResponse>({
            sendRequest: _sendRequest,
            initialHttpRequest: _request,
            clientOptions: this._options,
            requestOptions: requestOptions,
        });
    }

    /**
     * Use this method to retrieve information about a transaction.
     *
     * **Note:** To retrieve a transaction, you need its transactionId. If you don't have the transactionId, use our [List Transactions](https://docs.payroc.com/api/schema/reporting/settlement/list-transactions) method to search for the transaction.
     *
     * Our gateway returns the following information about the transaction:
     *
     * -	Merchant and processing account that ran the transaction.
     * -	Transaction type, date, amount, and the payment method that the customer used.
     * -	Batch that contains the transaction, and authorization details for the transaction.
     * -	Processor that settled the transaction and the ACH deposit containing the transaction.
     *
     * @param {Payroc.reporting.RetrieveTransactionSettlementRequest} request
     * @param {SettlementClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link Payroc.BadRequestError}
     * @throws {@link Payroc.UnauthorizedError}
     * @throws {@link Payroc.ForbiddenError}
     * @throws {@link Payroc.NotFoundError}
     * @throws {@link Payroc.NotAcceptableError}
     * @throws {@link Payroc.InternalServerError}
     *
     * @example
     *     await client.reporting.settlement.retrieveTransaction({
     *         transactionId: 1
     *     })
     */
    public retrieveTransaction(
        request: Payroc.reporting.RetrieveTransactionSettlementRequest,
        requestOptions?: SettlementClient.RequestOptions,
    ): core.HttpResponsePromise<Payroc.Transaction> {
        return core.HttpResponsePromise.fromPromise(this.__retrieveTransaction(request, requestOptions));
    }

    private async __retrieveTransaction(
        request: Payroc.reporting.RetrieveTransactionSettlementRequest,
        requestOptions?: SettlementClient.RequestOptions,
    ): Promise<core.WithRawResponse<Payroc.Transaction>> {
        const { transactionId } = request;
        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _response = await (this._options.fetcher ?? core.fetcher)({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    ((await core.Supplier.get(this._options.environment)) ?? environments.PayrocEnvironment.Production)
                        .api,
                `transactions/${core.url.encodePathParam(transactionId)}`,
            ),
            method: "GET",
            headers: _headers,
            queryParameters: requestOptions?.queryParams,
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        });
        if (_response.ok) {
            return { data: _response.body as Payroc.Transaction, rawResponse: _response.rawResponse };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new Payroc.BadRequestError(_response.error.body as Payroc.FourHundred, _response.rawResponse);
                case 401:
                    throw new Payroc.UnauthorizedError(
                        _response.error.body as Payroc.FourHundredOne,
                        _response.rawResponse,
                    );
                case 403:
                    throw new Payroc.ForbiddenError(_response.error.body as unknown, _response.rawResponse);
                case 404:
                    throw new Payroc.NotFoundError(
                        _response.error.body as Payroc.FourHundredFour,
                        _response.rawResponse,
                    );
                case 406:
                    throw new Payroc.NotAcceptableError(
                        _response.error.body as Payroc.FourHundredSix,
                        _response.rawResponse,
                    );
                case 500:
                    throw new Payroc.InternalServerError(
                        _response.error.body as Payroc.FiveHundred,
                        _response.rawResponse,
                    );
                default:
                    throw new errors.PayrocError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        return handleNonStatusCodeError(_response.error, _response.rawResponse, "GET", "/transactions/{transactionId}");
    }

    /**
     * Use this method to retrieve a [paginated](https://docs.payroc.com/api/pagination) list of authorizations.
     *
     * Use query parameters to filter the list of results that we return, for example, to search for authorizations linked to a specific merchant.
     *
     * > **Important:** You must provide a value for either the date query parameter or the batchId query parameter.
     *
     * Our gateway returns the following information about each authorization in the list:
     * - Authorization response from the issuing bank.
     * - Amount that the issuing bank authorized.
     * - Merchant that ran the authorization.
     * - Details about the customer's card, the transaction, and the batch.
     *
     * @param {Payroc.reporting.ListReportingSettlementAuthorizationsRequest} request
     * @param {SettlementClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link Payroc.BadRequestError}
     * @throws {@link Payroc.UnauthorizedError}
     * @throws {@link Payroc.ForbiddenError}
     * @throws {@link Payroc.NotAcceptableError}
     * @throws {@link Payroc.InternalServerError}
     *
     * @example
     *     await client.reporting.settlement.listAuthorizations({
     *         before: "2571",
     *         after: "8516",
     *         limit: 1,
     *         date: "2024-07-02",
     *         batchId: 1,
     *         merchantId: "4525644354"
     *     })
     */
    public async listAuthorizations(
        request: Payroc.reporting.ListReportingSettlementAuthorizationsRequest = {},
        requestOptions?: SettlementClient.RequestOptions,
    ): Promise<core.PayrocPager<Payroc.Authorization, Payroc.reporting.ListAuthorizationsSettlementResponse>> {
        const { before, after, limit, date, batchId, merchantId } = request;
        const _queryParams: Record<string, string | string[] | object | object[] | null> = {};
        if (before != null) {
            _queryParams.before = before;
        }

        if (after != null) {
            _queryParams.after = after;
        }

        if (limit != null) {
            _queryParams.limit = limit.toString();
        }

        if (date != null) {
            _queryParams.date = date;
        }

        if (batchId != null) {
            _queryParams.batchId = batchId.toString();
        }

        if (merchantId != null) {
            _queryParams.merchantId = merchantId;
        }

        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _request = {
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    ((await core.Supplier.get(this._options.environment)) ?? environments.PayrocEnvironment.Production)
                        .api,
                "authorizations",
            ),
            method: "GET",
            headers: _headers,
            queryParameters: { ..._queryParams, ...requestOptions?.queryParams },
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        };
        const _sendRequest = async (request: core.Fetcher.Args) => {
            const _response = await core.fetcher<Payroc.reporting.ListAuthorizationsSettlementResponse>(request);
            if (_response.ok) {
                return _response;
            }
            if (_response.error.reason === "status-code") {
                switch (_response.error.statusCode) {
                    case 400:
                        throw new Payroc.BadRequestError(
                            _response.error.body as Payroc.FourHundred,
                            _response.rawResponse,
                        );
                    case 401:
                        throw new Payroc.UnauthorizedError(
                            _response.error.body as Payroc.FourHundredOne,
                            _response.rawResponse,
                        );
                    case 403:
                        throw new Payroc.ForbiddenError(_response.error.body as unknown, _response.rawResponse);
                    case 406:
                        throw new Payroc.NotAcceptableError(
                            _response.error.body as Payroc.FourHundredSix,
                            _response.rawResponse,
                        );
                    case 500:
                        throw new Payroc.InternalServerError(
                            _response.error.body as Payroc.FiveHundred,
                            _response.rawResponse,
                        );
                    default:
                        throw new errors.PayrocError({
                            statusCode: _response.error.statusCode,
                            body: _response.error.body,
                            rawResponse: _response.rawResponse,
                        });
                }
            }
            return handleNonStatusCodeError(_response.error, _response.rawResponse, "GET", "/authorizations");
        };
        return core.createPayrocPager<Payroc.Authorization, Payroc.reporting.ListAuthorizationsSettlementResponse>({
            sendRequest: _sendRequest,
            initialHttpRequest: _request,
            clientOptions: this._options,
            requestOptions: requestOptions,
        });
    }

    /**
     * Use this method to retrieve information about an authorization.
     *
     * **Note:** To retrieve an authorization, you need its authorizationId. If you don't have the authorizationId, use our [List Authorizations](https://docs.payroc.com/api/schema/reporting/settlement/list-authorizations) method to search for the authorization.
     *
     * Our gateway returns the following information about the authorization:
     * - Authorization response from the issuing bank.
     * - Amount that the issuing bank authorized.
     * - Merchant that ran the authorization.
     * - Details about the customer's card, the transaction, and the batch.
     *
     * @param {Payroc.reporting.RetrieveAuthorizationSettlementRequest} request
     * @param {SettlementClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link Payroc.BadRequestError}
     * @throws {@link Payroc.UnauthorizedError}
     * @throws {@link Payroc.ForbiddenError}
     * @throws {@link Payroc.NotFoundError}
     * @throws {@link Payroc.NotAcceptableError}
     * @throws {@link Payroc.InternalServerError}
     *
     * @example
     *     await client.reporting.settlement.retrieveAuthorization({
     *         authorizationId: 1
     *     })
     */
    public retrieveAuthorization(
        request: Payroc.reporting.RetrieveAuthorizationSettlementRequest,
        requestOptions?: SettlementClient.RequestOptions,
    ): core.HttpResponsePromise<Payroc.Authorization> {
        return core.HttpResponsePromise.fromPromise(this.__retrieveAuthorization(request, requestOptions));
    }

    private async __retrieveAuthorization(
        request: Payroc.reporting.RetrieveAuthorizationSettlementRequest,
        requestOptions?: SettlementClient.RequestOptions,
    ): Promise<core.WithRawResponse<Payroc.Authorization>> {
        const { authorizationId } = request;
        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _response = await (this._options.fetcher ?? core.fetcher)({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    ((await core.Supplier.get(this._options.environment)) ?? environments.PayrocEnvironment.Production)
                        .api,
                `authorizations/${core.url.encodePathParam(authorizationId)}`,
            ),
            method: "GET",
            headers: _headers,
            queryParameters: requestOptions?.queryParams,
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        });
        if (_response.ok) {
            return { data: _response.body as Payroc.Authorization, rawResponse: _response.rawResponse };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new Payroc.BadRequestError(_response.error.body as Payroc.FourHundred, _response.rawResponse);
                case 401:
                    throw new Payroc.UnauthorizedError(
                        _response.error.body as Payroc.FourHundredOne,
                        _response.rawResponse,
                    );
                case 403:
                    throw new Payroc.ForbiddenError(_response.error.body as unknown, _response.rawResponse);
                case 404:
                    throw new Payroc.NotFoundError(
                        _response.error.body as Payroc.FourHundredFour,
                        _response.rawResponse,
                    );
                case 406:
                    throw new Payroc.NotAcceptableError(
                        _response.error.body as Payroc.FourHundredSix,
                        _response.rawResponse,
                    );
                case 500:
                    throw new Payroc.InternalServerError(
                        _response.error.body as Payroc.FiveHundred,
                        _response.rawResponse,
                    );
                default:
                    throw new errors.PayrocError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        return handleNonStatusCodeError(
            _response.error,
            _response.rawResponse,
            "GET",
            "/authorizations/{authorizationId}",
        );
    }

    /**
     * Use this method to return a [paginated](https://docs.payroc.com/api/pagination) list of disputes.
     *
     * Use query parameters to filter the list of results that we return, for example, to search for disputes linked to a specific merchant.
     *
     * > **Important:** You must provide a value for the date query parameter.
     *
     * Our gateway returns the following information about each dispute in the list:
     * - Its status, type, and description.
     * - Transaction that the dispute is linked to, including the transaction date, merchant who ran the transaction, and the payment method that the cardholder used.
     *
     * @param {Payroc.reporting.ListReportingSettlementDisputesRequest} request
     * @param {SettlementClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link Payroc.BadRequestError}
     * @throws {@link Payroc.UnauthorizedError}
     * @throws {@link Payroc.ForbiddenError}
     * @throws {@link Payroc.NotAcceptableError}
     * @throws {@link Payroc.InternalServerError}
     *
     * @example
     *     await client.reporting.settlement.listDisputes({
     *         before: "2571",
     *         after: "8516",
     *         limit: 1,
     *         date: "2024-07-02",
     *         merchantId: "4525644354"
     *     })
     */
    public async listDisputes(
        request: Payroc.reporting.ListReportingSettlementDisputesRequest,
        requestOptions?: SettlementClient.RequestOptions,
    ): Promise<core.PayrocPager<Payroc.Dispute, Payroc.reporting.ListDisputesSettlementResponse>> {
        const { before, after, limit, date, merchantId } = request;
        const _queryParams: Record<string, string | string[] | object | object[] | null> = {};
        if (before != null) {
            _queryParams.before = before;
        }

        if (after != null) {
            _queryParams.after = after;
        }

        if (limit != null) {
            _queryParams.limit = limit.toString();
        }

        _queryParams.date = date;
        if (merchantId != null) {
            _queryParams.merchantId = merchantId;
        }

        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _request = {
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    ((await core.Supplier.get(this._options.environment)) ?? environments.PayrocEnvironment.Production)
                        .api,
                "disputes",
            ),
            method: "GET",
            headers: _headers,
            queryParameters: { ..._queryParams, ...requestOptions?.queryParams },
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        };
        const _sendRequest = async (request: core.Fetcher.Args) => {
            const _response = await core.fetcher<Payroc.reporting.ListDisputesSettlementResponse>(request);
            if (_response.ok) {
                return _response;
            }
            if (_response.error.reason === "status-code") {
                switch (_response.error.statusCode) {
                    case 400:
                        throw new Payroc.BadRequestError(
                            _response.error.body as Payroc.FourHundred,
                            _response.rawResponse,
                        );
                    case 401:
                        throw new Payroc.UnauthorizedError(
                            _response.error.body as Payroc.FourHundredOne,
                            _response.rawResponse,
                        );
                    case 403:
                        throw new Payroc.ForbiddenError(_response.error.body as unknown, _response.rawResponse);
                    case 406:
                        throw new Payroc.NotAcceptableError(
                            _response.error.body as Payroc.FourHundredSix,
                            _response.rawResponse,
                        );
                    case 500:
                        throw new Payroc.InternalServerError(
                            _response.error.body as Payroc.FiveHundred,
                            _response.rawResponse,
                        );
                    default:
                        throw new errors.PayrocError({
                            statusCode: _response.error.statusCode,
                            body: _response.error.body,
                            rawResponse: _response.rawResponse,
                        });
                }
            }
            return handleNonStatusCodeError(_response.error, _response.rawResponse, "GET", "/disputes");
        };
        return core.createPayrocPager<Payroc.Dispute, Payroc.reporting.ListDisputesSettlementResponse>({
            sendRequest: _sendRequest,
            initialHttpRequest: _request,
            clientOptions: this._options,
            requestOptions: requestOptions,
        });
    }

    /**
     * Use this method to return the status history of a dispute.
     *
     * To view the status history of a dispute, you need its disputeId. If you don't have the disputeId, use our [List Disputes](https://docs.payroc.com/api/schema/reporting/settlement/list-disputes) method to search for the dispute.
     *
     * Our gateway returns a list that contains each status change, the date it was changed, and its updated status.
     *
     * @param {Payroc.reporting.ListDisputesStatusesSettlementRequest} request
     * @param {SettlementClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link Payroc.BadRequestError}
     * @throws {@link Payroc.UnauthorizedError}
     * @throws {@link Payroc.ForbiddenError}
     * @throws {@link Payroc.NotFoundError}
     * @throws {@link Payroc.NotAcceptableError}
     * @throws {@link Payroc.InternalServerError}
     *
     * @example
     *     await client.reporting.settlement.listDisputesStatuses({
     *         disputeId: 1
     *     })
     */
    public listDisputesStatuses(
        request: Payroc.reporting.ListDisputesStatusesSettlementRequest,
        requestOptions?: SettlementClient.RequestOptions,
    ): core.HttpResponsePromise<Payroc.DisputeStatus[]> {
        return core.HttpResponsePromise.fromPromise(this.__listDisputesStatuses(request, requestOptions));
    }

    private async __listDisputesStatuses(
        request: Payroc.reporting.ListDisputesStatusesSettlementRequest,
        requestOptions?: SettlementClient.RequestOptions,
    ): Promise<core.WithRawResponse<Payroc.DisputeStatus[]>> {
        const { disputeId } = request;
        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _response = await (this._options.fetcher ?? core.fetcher)({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    ((await core.Supplier.get(this._options.environment)) ?? environments.PayrocEnvironment.Production)
                        .api,
                `disputes/${core.url.encodePathParam(disputeId)}/statuses`,
            ),
            method: "GET",
            headers: _headers,
            queryParameters: requestOptions?.queryParams,
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        });
        if (_response.ok) {
            return { data: _response.body as Payroc.DisputeStatus[], rawResponse: _response.rawResponse };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new Payroc.BadRequestError(_response.error.body as Payroc.FourHundred, _response.rawResponse);
                case 401:
                    throw new Payroc.UnauthorizedError(
                        _response.error.body as Payroc.FourHundredOne,
                        _response.rawResponse,
                    );
                case 403:
                    throw new Payroc.ForbiddenError(_response.error.body as unknown, _response.rawResponse);
                case 404:
                    throw new Payroc.NotFoundError(
                        _response.error.body as Payroc.FourHundredFour,
                        _response.rawResponse,
                    );
                case 406:
                    throw new Payroc.NotAcceptableError(
                        _response.error.body as Payroc.FourHundredSix,
                        _response.rawResponse,
                    );
                case 500:
                    throw new Payroc.InternalServerError(
                        _response.error.body as Payroc.FiveHundred,
                        _response.rawResponse,
                    );
                default:
                    throw new errors.PayrocError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        return handleNonStatusCodeError(
            _response.error,
            _response.rawResponse,
            "GET",
            "/disputes/{disputeId}/statuses",
        );
    }

    /**
     * Use this method to return a [paginated](https://docs.payroc.com/api/pagination) list of ACH deposits that we paid to your merchants.
     *
     * **Note:** If you want to view the details of a specific ACH deposit and you have its achDepositId, use our [Retrieve ACH Deposit](https://docs.payroc.com/api/schema/reporting/settlement/retrieve-ach-deposit) method.
     *
     * Use query parameters to filter the list of results that we return, for example, to search for ACH deposits that we paid to a specific merchant.
     *
     * > **Important:** You must provide a value for the date query parameter.
     *
     * Our gateway returns the following information about each ACH deposit in the list:
     * - Merchant that we sent the ACH deposit to.
     * - Total amount that we paid the merchant.
     * - Breakdown of sales, returns, and fees.
     *
     * @param {Payroc.reporting.ListReportingSettlementAchDepositsRequest} request
     * @param {SettlementClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link Payroc.BadRequestError}
     * @throws {@link Payroc.UnauthorizedError}
     * @throws {@link Payroc.ForbiddenError}
     * @throws {@link Payroc.NotAcceptableError}
     * @throws {@link Payroc.InternalServerError}
     *
     * @example
     *     await client.reporting.settlement.listAchDeposits({
     *         before: "2571",
     *         after: "8516",
     *         limit: 1,
     *         date: "2024-07-02",
     *         merchantId: "4525644354"
     *     })
     */
    public async listAchDeposits(
        request: Payroc.reporting.ListReportingSettlementAchDepositsRequest,
        requestOptions?: SettlementClient.RequestOptions,
    ): Promise<core.PayrocPager<Payroc.AchDeposit, Payroc.reporting.ListAchDepositsSettlementResponse>> {
        const { before, after, limit, date, merchantId } = request;
        const _queryParams: Record<string, string | string[] | object | object[] | null> = {};
        if (before != null) {
            _queryParams.before = before;
        }

        if (after != null) {
            _queryParams.after = after;
        }

        if (limit != null) {
            _queryParams.limit = limit.toString();
        }

        _queryParams.date = date;
        if (merchantId != null) {
            _queryParams.merchantId = merchantId;
        }

        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _request = {
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    ((await core.Supplier.get(this._options.environment)) ?? environments.PayrocEnvironment.Production)
                        .api,
                "ach-deposits",
            ),
            method: "GET",
            headers: _headers,
            queryParameters: { ..._queryParams, ...requestOptions?.queryParams },
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        };
        const _sendRequest = async (request: core.Fetcher.Args) => {
            const _response = await core.fetcher<Payroc.reporting.ListAchDepositsSettlementResponse>(request);
            if (_response.ok) {
                return _response;
            }
            if (_response.error.reason === "status-code") {
                switch (_response.error.statusCode) {
                    case 400:
                        throw new Payroc.BadRequestError(
                            _response.error.body as Payroc.FourHundred,
                            _response.rawResponse,
                        );
                    case 401:
                        throw new Payroc.UnauthorizedError(
                            _response.error.body as Payroc.FourHundredOne,
                            _response.rawResponse,
                        );
                    case 403:
                        throw new Payroc.ForbiddenError(_response.error.body as unknown, _response.rawResponse);
                    case 406:
                        throw new Payroc.NotAcceptableError(
                            _response.error.body as Payroc.FourHundredSix,
                            _response.rawResponse,
                        );
                    case 500:
                        throw new Payroc.InternalServerError(
                            _response.error.body as Payroc.FiveHundred,
                            _response.rawResponse,
                        );
                    default:
                        throw new errors.PayrocError({
                            statusCode: _response.error.statusCode,
                            body: _response.error.body,
                            rawResponse: _response.rawResponse,
                        });
                }
            }
            return handleNonStatusCodeError(_response.error, _response.rawResponse, "GET", "/ach-deposits");
        };
        return core.createPayrocPager<Payroc.AchDeposit, Payroc.reporting.ListAchDepositsSettlementResponse>({
            sendRequest: _sendRequest,
            initialHttpRequest: _request,
            clientOptions: this._options,
            requestOptions: requestOptions,
        });
    }

    /**
     * Use this method to retrieve information about an ACH deposit that we paid to a merchant.
     *
     * **Note:** To retrieve an ACH deposit, you need its achDepositId. If you don't have the achDepositId, use our [List ACH Deposits](https://docs.payroc.com/api/schema/reporting/settlement/list-ach-deposits) method to search for the ACH deposit.
     *
     * Our gateway returns the following information about the ACH deposit:
     *
     * - Merchant that we sent the ACH deposit to.
     * - Total amount that we paid the merchant.
     * - Breakdown of sales, returns, and fees.
     *
     * @param {Payroc.reporting.RetrieveAchDepositSettlementRequest} request
     * @param {SettlementClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link Payroc.BadRequestError}
     * @throws {@link Payroc.UnauthorizedError}
     * @throws {@link Payroc.ForbiddenError}
     * @throws {@link Payroc.NotFoundError}
     * @throws {@link Payroc.NotAcceptableError}
     * @throws {@link Payroc.InternalServerError}
     *
     * @example
     *     await client.reporting.settlement.retrieveAchDeposit({
     *         achDepositId: 1
     *     })
     */
    public retrieveAchDeposit(
        request: Payroc.reporting.RetrieveAchDepositSettlementRequest,
        requestOptions?: SettlementClient.RequestOptions,
    ): core.HttpResponsePromise<Payroc.AchDeposit> {
        return core.HttpResponsePromise.fromPromise(this.__retrieveAchDeposit(request, requestOptions));
    }

    private async __retrieveAchDeposit(
        request: Payroc.reporting.RetrieveAchDepositSettlementRequest,
        requestOptions?: SettlementClient.RequestOptions,
    ): Promise<core.WithRawResponse<Payroc.AchDeposit>> {
        const { achDepositId } = request;
        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _response = await (this._options.fetcher ?? core.fetcher)({
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    ((await core.Supplier.get(this._options.environment)) ?? environments.PayrocEnvironment.Production)
                        .api,
                `ach-deposits/${core.url.encodePathParam(achDepositId)}`,
            ),
            method: "GET",
            headers: _headers,
            queryParameters: requestOptions?.queryParams,
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        });
        if (_response.ok) {
            return { data: _response.body as Payroc.AchDeposit, rawResponse: _response.rawResponse };
        }

        if (_response.error.reason === "status-code") {
            switch (_response.error.statusCode) {
                case 400:
                    throw new Payroc.BadRequestError(_response.error.body as Payroc.FourHundred, _response.rawResponse);
                case 401:
                    throw new Payroc.UnauthorizedError(
                        _response.error.body as Payroc.FourHundredOne,
                        _response.rawResponse,
                    );
                case 403:
                    throw new Payroc.ForbiddenError(_response.error.body as unknown, _response.rawResponse);
                case 404:
                    throw new Payroc.NotFoundError(
                        _response.error.body as Payroc.FourHundredFour,
                        _response.rawResponse,
                    );
                case 406:
                    throw new Payroc.NotAcceptableError(
                        _response.error.body as Payroc.FourHundredSix,
                        _response.rawResponse,
                    );
                case 500:
                    throw new Payroc.InternalServerError(
                        _response.error.body as Payroc.FiveHundred,
                        _response.rawResponse,
                    );
                default:
                    throw new errors.PayrocError({
                        statusCode: _response.error.statusCode,
                        body: _response.error.body,
                        rawResponse: _response.rawResponse,
                    });
            }
        }

        return handleNonStatusCodeError(_response.error, _response.rawResponse, "GET", "/ach-deposits/{achDepositId}");
    }

    /**
     * Retrieve a list of ACH deposit fees.
     *
     * > **Important:** You must provide a value for either the 'date' query parameter or the 'achDepositId' query parameter.
     *
     * @param {Payroc.reporting.ListReportingSettlementAchDepositFeesRequest} request
     * @param {SettlementClient.RequestOptions} requestOptions - Request-specific configuration.
     *
     * @throws {@link Payroc.BadRequestError}
     * @throws {@link Payroc.UnauthorizedError}
     * @throws {@link Payroc.ForbiddenError}
     * @throws {@link Payroc.NotAcceptableError}
     * @throws {@link Payroc.InternalServerError}
     *
     * @example
     *     await client.reporting.settlement.listAchDepositFees({
     *         before: "2571",
     *         after: "8516",
     *         limit: 1,
     *         date: "2024-07-02",
     *         achDepositId: 1,
     *         merchantId: "4525644354"
     *     })
     */
    public async listAchDepositFees(
        request: Payroc.reporting.ListReportingSettlementAchDepositFeesRequest = {},
        requestOptions?: SettlementClient.RequestOptions,
    ): Promise<core.PayrocPager<Payroc.AchDepositFee, Payroc.reporting.ListAchDepositFeesSettlementResponse>> {
        const { before, after, limit, date, achDepositId, merchantId } = request;
        const _queryParams: Record<string, string | string[] | object | object[] | null> = {};
        if (before != null) {
            _queryParams.before = before;
        }

        if (after != null) {
            _queryParams.after = after;
        }

        if (limit != null) {
            _queryParams.limit = limit.toString();
        }

        if (date != null) {
            _queryParams.date = date;
        }

        if (achDepositId != null) {
            _queryParams.achDepositId = achDepositId.toString();
        }

        if (merchantId != null) {
            _queryParams.merchantId = merchantId;
        }

        const _authRequest: core.AuthRequest = await this._options.authProvider.getAuthRequest();
        const _headers: core.Fetcher.Args["headers"] = mergeHeaders(
            _authRequest.headers,
            this._options?.headers,
            requestOptions?.headers,
        );
        const _request = {
            url: core.url.join(
                (await core.Supplier.get(this._options.baseUrl)) ??
                    ((await core.Supplier.get(this._options.environment)) ?? environments.PayrocEnvironment.Production)
                        .api,
                "ach-deposit-fees",
            ),
            method: "GET",
            headers: _headers,
            queryParameters: { ..._queryParams, ...requestOptions?.queryParams },
            timeoutMs: (requestOptions?.timeoutInSeconds ?? this._options?.timeoutInSeconds ?? 60) * 1000,
            maxRetries: requestOptions?.maxRetries ?? this._options?.maxRetries,
            abortSignal: requestOptions?.abortSignal,
            fetchFn: this._options?.fetch,
            logging: this._options.logging,
        };
        const _sendRequest = async (request: core.Fetcher.Args) => {
            const _response = await core.fetcher<Payroc.reporting.ListAchDepositFeesSettlementResponse>(request);
            if (_response.ok) {
                return _response;
            }
            if (_response.error.reason === "status-code") {
                switch (_response.error.statusCode) {
                    case 400:
                        throw new Payroc.BadRequestError(
                            _response.error.body as Payroc.FourHundred,
                            _response.rawResponse,
                        );
                    case 401:
                        throw new Payroc.UnauthorizedError(
                            _response.error.body as Payroc.FourHundredOne,
                            _response.rawResponse,
                        );
                    case 403:
                        throw new Payroc.ForbiddenError(_response.error.body as unknown, _response.rawResponse);
                    case 406:
                        throw new Payroc.NotAcceptableError(
                            _response.error.body as Payroc.FourHundredSix,
                            _response.rawResponse,
                        );
                    case 500:
                        throw new Payroc.InternalServerError(
                            _response.error.body as Payroc.FiveHundred,
                            _response.rawResponse,
                        );
                    default:
                        throw new errors.PayrocError({
                            statusCode: _response.error.statusCode,
                            body: _response.error.body,
                            rawResponse: _response.rawResponse,
                        });
                }
            }
            return handleNonStatusCodeError(_response.error, _response.rawResponse, "GET", "/ach-deposit-fees");
        };
        return core.createPayrocPager<Payroc.AchDepositFee, Payroc.reporting.ListAchDepositFeesSettlementResponse>({
            sendRequest: _sendRequest,
            initialHttpRequest: _request,
            clientOptions: this._options,
            requestOptions: requestOptions,
        });
    }
}
