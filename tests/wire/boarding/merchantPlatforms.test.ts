// This file was auto-generated by Fern from our API Definition.

import * as Payroc from "../../../src/api/index";
import { PayrocClient } from "../../../src/Client";
import { mockServerPool } from "../../mock-server/MockServerPool";
import { mockBearer } from "../mockAuth";

describe("MerchantPlatformsClient", () => {
    test("list (1)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = {
            limit: 2,
            count: 2,
            hasMore: true,
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "https://api.payroc.com/v1/merchant-platforms?before=12345&limit=2",
                },
                {
                    rel: "next",
                    method: "get",
                    href: "https://api.payroc.com/v1/merchant-platforms?after=12346&limit=2",
                },
            ],
            data: [
                {
                    merchantPlatformId: "12345",
                    createdDate: "2024-07-02T12:00:00Z",
                    lastModifiedDate: "2024-07-02T12:00:00Z",
                    business: {
                        name: "Example Corp",
                        taxId: "xxxxx6789",
                        organizationType: "privateCorporation",
                        countryOfOperation: "US",
                        addresses: [
                            {
                                address1: "1 Example Ave.",
                                address2: "Example Address Line 2",
                                address3: "Example Address Line 3",
                                city: "Chicago",
                                state: "Illinois",
                                country: "US",
                                postalCode: "60056",
                                type: "legalAddress",
                            },
                        ],
                        contactMethods: [
                            { type: "email", value: "jane.doe@example.com" },
                            { type: "phone", value: "2025550164" },
                        ],
                    },
                    processingAccounts: [
                        {
                            processingAccountId: "38765",
                            doingBusinessAs: "Pizza Doe",
                            status: "pending",
                            link: {
                                rel: "processingAccount",
                                href: "https://api.payroc.com/v1/processing-accounts/38765",
                                method: "get",
                            },
                            signature: {
                                type: "requestedViaDirectLink",
                                link: { rel: "previous", method: "get", href: "<uri>" },
                            },
                        },
                    ],
                    metadata: { customerId: "2345" },
                    links: [{ rel: "previous", method: "get", href: "<uri>" }],
                },
                {
                    merchantPlatformId: "12346",
                    createdDate: "2024-07-02T12:00:00Z",
                    lastModifiedDate: "2024-07-02T12:00:00Z",
                    business: {
                        name: "Example Corp",
                        taxId: "xxxxx6789",
                        organizationType: "privateCorporation",
                        countryOfOperation: "US",
                        addresses: [
                            {
                                address1: "1 Example Ave.",
                                address2: "Example Address Line 2",
                                address3: "Example Address Line 3",
                                city: "Chicago",
                                state: "Illinois",
                                country: "US",
                                postalCode: "60056",
                                type: "legalAddress",
                            },
                        ],
                        contactMethods: [
                            { type: "email", value: "jane.doe@example.com" },
                            { type: "phone", value: "2025550164" },
                        ],
                    },
                    processingAccounts: [
                        {
                            processingAccountId: "38766",
                            doingBusinessAs: "Doe Hot Dogs",
                            status: "pending",
                            link: {
                                rel: "processingAccount",
                                href: "https://api.payroc.com/v1/processing-accounts/38766",
                                method: "get",
                            },
                            signature: {
                                type: "requestedViaDirectLink",
                                link: { rel: "previous", method: "get", href: "<uri>" },
                            },
                        },
                    ],
                    metadata: { customerId: "2345" },
                    links: [{ rel: "previous", method: "get", href: "<uri>" }],
                },
            ],
        };
        server
            .mockEndpoint({ once: false })
            .get("/merchant-platforms")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const expected = {
            limit: 2,
            count: 2,
            hasMore: true,
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "https://api.payroc.com/v1/merchant-platforms?before=12345&limit=2",
                },
                {
                    rel: "next",
                    method: "get",
                    href: "https://api.payroc.com/v1/merchant-platforms?after=12346&limit=2",
                },
            ],
            data: [
                {
                    merchantPlatformId: "12345",
                    createdDate: "2024-07-02T12:00:00Z",
                    lastModifiedDate: "2024-07-02T12:00:00Z",
                    business: {
                        name: "Example Corp",
                        taxId: "xxxxx6789",
                        organizationType: "privateCorporation",
                        countryOfOperation: "US",
                        addresses: [
                            {
                                address1: "1 Example Ave.",
                                address2: "Example Address Line 2",
                                address3: "Example Address Line 3",
                                city: "Chicago",
                                state: "Illinois",
                                country: "US",
                                postalCode: "60056",
                                type: "legalAddress",
                            },
                        ],
                        contactMethods: [
                            {
                                type: "email",
                                value: "jane.doe@example.com",
                            },
                            {
                                type: "phone",
                                value: "2025550164",
                            },
                        ],
                    },
                    processingAccounts: [
                        {
                            processingAccountId: "38765",
                            doingBusinessAs: "Pizza Doe",
                            status: "pending",
                            link: {
                                rel: "processingAccount",
                                href: "https://api.payroc.com/v1/processing-accounts/38765",
                                method: "get",
                            },
                            signature: {
                                type: "requestedViaDirectLink",
                                link: {
                                    rel: "previous",
                                    method: "get",
                                    href: "<uri>",
                                },
                            },
                        },
                    ],
                    metadata: {
                        customerId: "2345",
                    },
                    links: [
                        {
                            rel: "previous",
                            method: "get",
                            href: "<uri>",
                        },
                    ],
                },
                {
                    merchantPlatformId: "12346",
                    createdDate: "2024-07-02T12:00:00Z",
                    lastModifiedDate: "2024-07-02T12:00:00Z",
                    business: {
                        name: "Example Corp",
                        taxId: "xxxxx6789",
                        organizationType: "privateCorporation",
                        countryOfOperation: "US",
                        addresses: [
                            {
                                address1: "1 Example Ave.",
                                address2: "Example Address Line 2",
                                address3: "Example Address Line 3",
                                city: "Chicago",
                                state: "Illinois",
                                country: "US",
                                postalCode: "60056",
                                type: "legalAddress",
                            },
                        ],
                        contactMethods: [
                            {
                                type: "email",
                                value: "jane.doe@example.com",
                            },
                            {
                                type: "phone",
                                value: "2025550164",
                            },
                        ],
                    },
                    processingAccounts: [
                        {
                            processingAccountId: "38766",
                            doingBusinessAs: "Doe Hot Dogs",
                            status: "pending",
                            link: {
                                rel: "processingAccount",
                                href: "https://api.payroc.com/v1/processing-accounts/38766",
                                method: "get",
                            },
                            signature: {
                                type: "requestedViaDirectLink",
                                link: {
                                    rel: "previous",
                                    method: "get",
                                    href: "<uri>",
                                },
                            },
                        },
                    ],
                    metadata: {
                        customerId: "2345",
                    },
                    links: [
                        {
                            rel: "previous",
                            method: "get",
                            href: "<uri>",
                        },
                    ],
                },
            ],
        };
        const page = await client.boarding.merchantPlatforms.list({
            before: "2571",
            after: "8516",
            limit: 1,
        });
        expect(expected.data).toEqual(page.data);
    });

    test("list (2)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = {
            limit: 10,
            count: 0,
            hasMore: false,
            links: [
                { rel: "previous", method: "get", href: "<uri>" },
                { rel: "next", method: "get", href: "<uri>" },
            ],
            data: [
                {
                    merchantPlatformId: "12345",
                    createdDate: "2024-07-02T12:00:00Z",
                    lastModifiedDate: "2024-07-02T12:00:00Z",
                    business: {
                        name: "Pizza Doe",
                        taxId: "12-3456789",
                        organizationType: "privateCorporation",
                        addresses: [
                            {
                                address1: "1 Example Ave.",
                                address2: "Example Address Line 2",
                                address3: "Example Address Line 3",
                                city: "Chicago",
                                state: "Illinois",
                                country: "US",
                                postalCode: "60056",
                                type: "legalAddress",
                            },
                        ],
                        contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
                    },
                    processingAccounts: [{ processingAccountId: "38765", doingBusinessAs: "Pizza Doe" }],
                    metadata: { customerId: "2345" },
                    links: [{ rel: "previous", method: "get", href: "<uri>" }],
                },
            ],
        };
        server
            .mockEndpoint({ once: false })
            .get("/merchant-platforms")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const expected = {
            limit: 10,
            count: 0,
            hasMore: false,
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "<uri>",
                },
                {
                    rel: "next",
                    method: "get",
                    href: "<uri>",
                },
            ],
            data: [
                {
                    merchantPlatformId: "12345",
                    createdDate: "2024-07-02T12:00:00Z",
                    lastModifiedDate: "2024-07-02T12:00:00Z",
                    business: {
                        name: "Pizza Doe",
                        taxId: "12-3456789",
                        organizationType: "privateCorporation",
                        addresses: [
                            {
                                address1: "1 Example Ave.",
                                address2: "Example Address Line 2",
                                address3: "Example Address Line 3",
                                city: "Chicago",
                                state: "Illinois",
                                country: "US",
                                postalCode: "60056",
                                type: "legalAddress",
                            },
                        ],
                        contactMethods: [
                            {
                                type: "email",
                                value: "jane.doe@example.com",
                            },
                        ],
                    },
                    processingAccounts: [
                        {
                            processingAccountId: "38765",
                            doingBusinessAs: "Pizza Doe",
                        },
                    ],
                    metadata: {
                        customerId: "2345",
                    },
                    links: [
                        {
                            rel: "previous",
                            method: "get",
                            href: "<uri>",
                        },
                    ],
                },
            ],
        };
        const page = await client.boarding.merchantPlatforms.list({
            before: "2571",
            after: "8516",
            limit: 1,
        });
        expect(expected.data).toEqual(page.data);
    });

    test("list (3)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint({ once: false })
            .get("/merchant-platforms")
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.list();
        }).rejects.toThrow(Payroc.UnauthorizedError);
    });

    test("list (4)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint({ once: false })
            .get("/merchant-platforms")
            .respondWith()
            .statusCode(403)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.list();
        }).rejects.toThrow(Payroc.ForbiddenError);
    });

    test("list (5)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint({ once: false })
            .get("/merchant-platforms")
            .respondWith()
            .statusCode(406)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.list();
        }).rejects.toThrow(Payroc.NotAcceptableError);
    });

    test("list (6)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint({ once: false })
            .get("/merchant-platforms")
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.list();
        }).rejects.toThrow(Payroc.InternalServerError);
    });

    test("create (1)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            business: {
                name: "Example Corp",
                taxId: "12-3456789",
                organizationType: "privateCorporation",
                countryOfOperation: "US",
                addresses: [
                    {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                        type: "legalAddress",
                    },
                ],
                contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
            },
            processingAccounts: [
                {
                    doingBusinessAs: "Pizza Doe",
                    owners: [
                        {
                            firstName: "Jane",
                            middleName: "Helen",
                            lastName: "Doe",
                            dateOfBirth: "1964-03-22",
                            address: {
                                address1: "1 Example Ave.",
                                address2: "Example Address Line 2",
                                address3: "Example Address Line 3",
                                city: "Chicago",
                                state: "Illinois",
                                country: "US",
                                postalCode: "60056",
                            },
                            identifiers: [{ type: "nationalId", value: "000-00-4320" }],
                            contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
                            relationship: {
                                equityPercentage: 48.5,
                                title: "CFO",
                                isControlProng: true,
                                isAuthorizedSignatory: false,
                            },
                        },
                    ],
                    website: "www.example.com",
                    businessType: "restaurant",
                    categoryCode: 5999,
                    merchandiseOrServiceSold: "Pizza",
                    businessStartDate: "2020-01-01",
                    timezone: "America/Chicago",
                    address: {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                    },
                    contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
                    processing: {
                        transactionAmounts: { average: 5000, highest: 10000 },
                        monthlyAmounts: { average: 50000, highest: 100000 },
                        volumeBreakdown: {
                            cardPresentKeyed: 47,
                            cardPresentSwiped: 30,
                            mailOrTelephone: 3,
                            ecommerce: 20,
                        },
                        isSeasonal: true,
                        monthsOfOperation: ["jan", "feb"],
                        ach: {
                            naics: "5812",
                            previouslyTerminatedForAch: false,
                            refunds: {
                                writtenRefundPolicy: true,
                                refundPolicyUrl: "www.example.com/refund-poilcy-url",
                            },
                            estimatedMonthlyTransactions: 3000,
                            limits: { singleTransaction: 10000, dailyDeposit: 200000, monthlyDeposit: 6000000 },
                            transactionTypes: ["prearrangedPayment", "other"],
                            transactionTypesOther: "anotherTransactionType",
                        },
                        cardAcceptance: {
                            debitOnly: false,
                            hsaFsa: false,
                            cardsAccepted: ["visa", "mastercard"],
                            specialityCards: {
                                americanExpressDirect: { enabled: true, merchantNumber: "abc1234567" },
                                electronicBenefitsTransfer: { enabled: true, fnsNumber: "6789012" },
                                other: {
                                    wexMerchantNumber: "abc1234567",
                                    voyagerMerchantId: "abc1234567",
                                    fleetMerchantId: "abc1234567",
                                },
                            },
                        },
                    },
                    funding: {
                        fundingSchedule: "nextday",
                        acceleratedFundingFee: 1999,
                        dailyDiscount: false,
                        fundingAccounts: [
                            {
                                type: "checking",
                                use: "creditAndDebit",
                                nameOnAccount: "Jane Doe",
                                paymentMethods: [{ type: "ach" }],
                                metadata: { yourCustomField: "abc123" },
                            },
                        ],
                    },
                    pricing: { type: "intent", pricingIntentId: "6123" },
                    signature: { type: "requestedViaDirectLink" },
                    contacts: [
                        {
                            type: "manager",
                            firstName: "Jane",
                            middleName: "Helen",
                            lastName: "Doe",
                            identifiers: [{ type: "nationalId", value: "000-00-4320" }],
                            contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
                        },
                    ],
                    metadata: { customerId: "2345" },
                },
            ],
            metadata: { customerId: "2345" },
        };
        const rawResponseBody = {
            merchantPlatformId: "12345",
            createdDate: "2024-07-02T12:00:00Z",
            lastModifiedDate: "2024-07-02T12:00:00Z",
            business: {
                name: "Example Corp",
                taxId: "xxxxx6789",
                organizationType: "privateCorporation",
                countryOfOperation: "US",
                addresses: [
                    {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                        type: "legalAddress",
                    },
                ],
                contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
            },
            processingAccounts: [
                {
                    processingAccountId: "38765",
                    doingBusinessAs: "Pizza Doe",
                    status: "pending",
                    link: {
                        rel: "processingAccount",
                        href: "https://api.payroc.com/v1/processing-accounts/38765",
                        method: "get",
                    },
                    signature: {
                        type: "requestedViaDirectLink",
                        link: { rel: "previous", method: "get", href: "<uri>" },
                    },
                },
            ],
            metadata: { customerId: "2345" },
            links: [{ rel: "previous", method: "get", href: "<uri>" }],
        };
        server
            .mockEndpoint()
            .post("/merchant-platforms")
            .header("Idempotency-Key", "8e03978e-40d5-43e8-bc93-6894a57f9324")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.boarding.merchantPlatforms.create({
            "Idempotency-Key": "8e03978e-40d5-43e8-bc93-6894a57f9324",
            business: {
                name: "Example Corp",
                taxId: "12-3456789",
                organizationType: "privateCorporation",
                countryOfOperation: "US",
                addresses: [
                    {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                        type: "legalAddress",
                    },
                ],
                contactMethods: [
                    {
                        type: "email",
                        value: "jane.doe@example.com",
                    },
                ],
            },
            processingAccounts: [
                {
                    doingBusinessAs: "Pizza Doe",
                    owners: [
                        {
                            firstName: "Jane",
                            middleName: "Helen",
                            lastName: "Doe",
                            dateOfBirth: "1964-03-22",
                            address: {
                                address1: "1 Example Ave.",
                                address2: "Example Address Line 2",
                                address3: "Example Address Line 3",
                                city: "Chicago",
                                state: "Illinois",
                                country: "US",
                                postalCode: "60056",
                            },
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "000-00-4320",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "jane.doe@example.com",
                                },
                            ],
                            relationship: {
                                equityPercentage: 48.5,
                                title: "CFO",
                                isControlProng: true,
                                isAuthorizedSignatory: false,
                            },
                        },
                    ],
                    website: "www.example.com",
                    businessType: "restaurant",
                    categoryCode: 5999,
                    merchandiseOrServiceSold: "Pizza",
                    businessStartDate: "2020-01-01",
                    timezone: "America/Chicago",
                    address: {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                    },
                    contactMethods: [
                        {
                            type: "email",
                            value: "jane.doe@example.com",
                        },
                    ],
                    processing: {
                        transactionAmounts: {
                            average: 5000,
                            highest: 10000,
                        },
                        monthlyAmounts: {
                            average: 50000,
                            highest: 100000,
                        },
                        volumeBreakdown: {
                            cardPresentKeyed: 47,
                            cardPresentSwiped: 30,
                            mailOrTelephone: 3,
                            ecommerce: 20,
                        },
                        isSeasonal: true,
                        monthsOfOperation: ["jan", "feb"],
                        ach: {
                            naics: "5812",
                            previouslyTerminatedForAch: false,
                            refunds: {
                                writtenRefundPolicy: true,
                                refundPolicyUrl: "www.example.com/refund-poilcy-url",
                            },
                            estimatedMonthlyTransactions: 3000,
                            limits: {
                                singleTransaction: 10000,
                                dailyDeposit: 200000,
                                monthlyDeposit: 6000000,
                            },
                            transactionTypes: ["prearrangedPayment", "other"],
                            transactionTypesOther: "anotherTransactionType",
                        },
                        cardAcceptance: {
                            debitOnly: false,
                            hsaFsa: false,
                            cardsAccepted: ["visa", "mastercard"],
                            specialityCards: {
                                americanExpressDirect: {
                                    enabled: true,
                                    merchantNumber: "abc1234567",
                                },
                                electronicBenefitsTransfer: {
                                    enabled: true,
                                    fnsNumber: "6789012",
                                },
                                other: {
                                    wexMerchantNumber: "abc1234567",
                                    voyagerMerchantId: "abc1234567",
                                    fleetMerchantId: "abc1234567",
                                },
                            },
                        },
                    },
                    funding: {
                        fundingSchedule: "nextday",
                        acceleratedFundingFee: 1999,
                        dailyDiscount: false,
                        fundingAccounts: [
                            {
                                type: "checking",
                                use: "creditAndDebit",
                                nameOnAccount: "Jane Doe",
                                paymentMethods: [
                                    {
                                        type: "ach",
                                    },
                                ],
                                metadata: {
                                    yourCustomField: "abc123",
                                },
                            },
                        ],
                    },
                    pricing: {
                        type: "intent",
                        pricingIntentId: "6123",
                    },
                    signature: {
                        type: "requestedViaDirectLink",
                    },
                    contacts: [
                        {
                            type: "manager",
                            firstName: "Jane",
                            middleName: "Helen",
                            lastName: "Doe",
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "000-00-4320",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "jane.doe@example.com",
                                },
                            ],
                        },
                    ],
                    metadata: {
                        customerId: "2345",
                    },
                },
            ],
            metadata: {
                customerId: "2345",
            },
        });
        expect(response).toEqual({
            merchantPlatformId: "12345",
            createdDate: "2024-07-02T12:00:00Z",
            lastModifiedDate: "2024-07-02T12:00:00Z",
            business: {
                name: "Example Corp",
                taxId: "xxxxx6789",
                organizationType: "privateCorporation",
                countryOfOperation: "US",
                addresses: [
                    {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                        type: "legalAddress",
                    },
                ],
                contactMethods: [
                    {
                        type: "email",
                        value: "jane.doe@example.com",
                    },
                ],
            },
            processingAccounts: [
                {
                    processingAccountId: "38765",
                    doingBusinessAs: "Pizza Doe",
                    status: "pending",
                    link: {
                        rel: "processingAccount",
                        href: "https://api.payroc.com/v1/processing-accounts/38765",
                        method: "get",
                    },
                    signature: {
                        type: "requestedViaDirectLink",
                        link: {
                            rel: "previous",
                            method: "get",
                            href: "<uri>",
                        },
                    },
                },
            ],
            metadata: {
                customerId: "2345",
            },
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "<uri>",
                },
            ],
        });
    });

    test("create (2)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            business: {
                name: "Example Corp",
                taxId: "12-3456789",
                organizationType: "privateCorporation",
                countryOfOperation: "US",
                addresses: [
                    {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                        type: "legalAddress",
                    },
                ],
                contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
            },
            processingAccounts: [
                {
                    doingBusinessAs: "Pizza Doe",
                    owners: [
                        {
                            firstName: "Jane",
                            middleName: "Helen",
                            lastName: "Doe",
                            dateOfBirth: "1964-03-22",
                            address: {
                                address1: "1 Example Ave.",
                                address2: "Example Address Line 2",
                                address3: "Example Address Line 3",
                                city: "Chicago",
                                state: "Illinois",
                                country: "US",
                                postalCode: "60056",
                            },
                            identifiers: [{ type: "nationalId", value: "000-00-4320" }],
                            contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
                            relationship: {
                                equityPercentage: 48.5,
                                title: "CFO",
                                isControlProng: true,
                                isAuthorizedSignatory: false,
                            },
                        },
                    ],
                    website: "www.example.com",
                    businessType: "restaurant",
                    categoryCode: 5999,
                    merchandiseOrServiceSold: "Pizza",
                    businessStartDate: "2020-01-01",
                    timezone: "America/Chicago",
                    address: {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                    },
                    contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
                    processing: {
                        transactionAmounts: { average: 5000, highest: 10000 },
                        monthlyAmounts: { average: 50000, highest: 100000 },
                        volumeBreakdown: {
                            cardPresentKeyed: 47,
                            cardPresentSwiped: 30,
                            mailOrTelephone: 3,
                            ecommerce: 20,
                        },
                        isSeasonal: true,
                        monthsOfOperation: ["jan", "feb"],
                        ach: {
                            naics: "5812",
                            previouslyTerminatedForAch: false,
                            refunds: {
                                writtenRefundPolicy: true,
                                refundPolicyUrl: "www.example.com/refund-poilcy-url",
                            },
                            estimatedMonthlyTransactions: 3000,
                            limits: { singleTransaction: 10000, dailyDeposit: 200000, monthlyDeposit: 6000000 },
                            transactionTypes: ["prearrangedPayment", "other"],
                            transactionTypesOther: "anotherTransactionType",
                        },
                        cardAcceptance: {
                            debitOnly: false,
                            hsaFsa: false,
                            cardsAccepted: ["visa", "mastercard"],
                            specialityCards: {
                                americanExpressDirect: { enabled: true, merchantNumber: "abc1234567" },
                                electronicBenefitsTransfer: { enabled: true, fnsNumber: "6789012" },
                                other: {
                                    wexMerchantNumber: "abc1234567",
                                    voyagerMerchantId: "abc1234567",
                                    fleetMerchantId: "abc1234567",
                                },
                            },
                        },
                    },
                    funding: {
                        fundingSchedule: "nextday",
                        acceleratedFundingFee: 1999,
                        dailyDiscount: false,
                        fundingAccounts: [
                            {
                                type: "checking",
                                use: "creditAndDebit",
                                nameOnAccount: "Jane Doe",
                                paymentMethods: [{ type: "ach" }],
                                metadata: { yourCustomField: "abc123" },
                            },
                        ],
                    },
                    pricing: { type: "intent", pricingIntentId: "6123" },
                    signature: { type: "requestedViaDirectLink" },
                    contacts: [
                        {
                            type: "manager",
                            firstName: "Jane",
                            middleName: "Helen",
                            lastName: "Doe",
                            identifiers: [{ type: "nationalId", value: "000-00-4320" }],
                            contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
                        },
                    ],
                    metadata: { customerId: "2345" },
                },
            ],
            metadata: { customerId: "2345" },
        };
        const rawResponseBody = {
            merchantPlatformId: "12346",
            createdDate: "2024-07-02T12:00:00Z",
            lastModifiedDate: "2024-07-02T12:00:00Z",
            business: {
                name: "Example Corp",
                taxId: "xxxxx6789",
                organizationType: "privateCorporation",
                countryOfOperation: "US",
                addresses: [
                    {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                        type: "legalAddress",
                    },
                ],
                contactMethods: [
                    { type: "email", value: "jane.doe@example.com" },
                    { type: "phone", value: "2025550164" },
                ],
            },
            processingAccounts: [
                {
                    processingAccountId: "38765",
                    doingBusinessAs: "Pizza Doe",
                    status: "failed",
                    link: {
                        rel: "processingAccount",
                        href: "https://api.payroc.com/v1/processing-accounts/38765",
                        method: "get",
                    },
                    signature: {
                        type: "requestedViaDirectLink",
                        link: { rel: "previous", method: "get", href: "<uri>" },
                    },
                },
            ],
            metadata: { customerId: "2345" },
            links: [{ rel: "previous", method: "get", href: "<uri>" }],
        };
        server
            .mockEndpoint()
            .post("/merchant-platforms")
            .header("Idempotency-Key", "8e03978e-40d5-43e8-bc93-6894a57f9324")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.boarding.merchantPlatforms.create({
            "Idempotency-Key": "8e03978e-40d5-43e8-bc93-6894a57f9324",
            business: {
                name: "Example Corp",
                taxId: "12-3456789",
                organizationType: "privateCorporation",
                countryOfOperation: "US",
                addresses: [
                    {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                        type: "legalAddress",
                    },
                ],
                contactMethods: [
                    {
                        type: "email",
                        value: "jane.doe@example.com",
                    },
                ],
            },
            processingAccounts: [
                {
                    doingBusinessAs: "Pizza Doe",
                    owners: [
                        {
                            firstName: "Jane",
                            middleName: "Helen",
                            lastName: "Doe",
                            dateOfBirth: "1964-03-22",
                            address: {
                                address1: "1 Example Ave.",
                                address2: "Example Address Line 2",
                                address3: "Example Address Line 3",
                                city: "Chicago",
                                state: "Illinois",
                                country: "US",
                                postalCode: "60056",
                            },
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "000-00-4320",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "jane.doe@example.com",
                                },
                            ],
                            relationship: {
                                equityPercentage: 48.5,
                                title: "CFO",
                                isControlProng: true,
                                isAuthorizedSignatory: false,
                            },
                        },
                    ],
                    website: "www.example.com",
                    businessType: "restaurant",
                    categoryCode: 5999,
                    merchandiseOrServiceSold: "Pizza",
                    businessStartDate: "2020-01-01",
                    timezone: "America/Chicago",
                    address: {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                    },
                    contactMethods: [
                        {
                            type: "email",
                            value: "jane.doe@example.com",
                        },
                    ],
                    processing: {
                        transactionAmounts: {
                            average: 5000,
                            highest: 10000,
                        },
                        monthlyAmounts: {
                            average: 50000,
                            highest: 100000,
                        },
                        volumeBreakdown: {
                            cardPresentKeyed: 47,
                            cardPresentSwiped: 30,
                            mailOrTelephone: 3,
                            ecommerce: 20,
                        },
                        isSeasonal: true,
                        monthsOfOperation: ["jan", "feb"],
                        ach: {
                            naics: "5812",
                            previouslyTerminatedForAch: false,
                            refunds: {
                                writtenRefundPolicy: true,
                                refundPolicyUrl: "www.example.com/refund-poilcy-url",
                            },
                            estimatedMonthlyTransactions: 3000,
                            limits: {
                                singleTransaction: 10000,
                                dailyDeposit: 200000,
                                monthlyDeposit: 6000000,
                            },
                            transactionTypes: ["prearrangedPayment", "other"],
                            transactionTypesOther: "anotherTransactionType",
                        },
                        cardAcceptance: {
                            debitOnly: false,
                            hsaFsa: false,
                            cardsAccepted: ["visa", "mastercard"],
                            specialityCards: {
                                americanExpressDirect: {
                                    enabled: true,
                                    merchantNumber: "abc1234567",
                                },
                                electronicBenefitsTransfer: {
                                    enabled: true,
                                    fnsNumber: "6789012",
                                },
                                other: {
                                    wexMerchantNumber: "abc1234567",
                                    voyagerMerchantId: "abc1234567",
                                    fleetMerchantId: "abc1234567",
                                },
                            },
                        },
                    },
                    funding: {
                        fundingSchedule: "nextday",
                        acceleratedFundingFee: 1999,
                        dailyDiscount: false,
                        fundingAccounts: [
                            {
                                type: "checking",
                                use: "creditAndDebit",
                                nameOnAccount: "Jane Doe",
                                paymentMethods: [
                                    {
                                        type: "ach",
                                    },
                                ],
                                metadata: {
                                    yourCustomField: "abc123",
                                },
                            },
                        ],
                    },
                    pricing: {
                        type: "intent",
                        pricingIntentId: "6123",
                    },
                    signature: {
                        type: "requestedViaDirectLink",
                    },
                    contacts: [
                        {
                            type: "manager",
                            firstName: "Jane",
                            middleName: "Helen",
                            lastName: "Doe",
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "000-00-4320",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "jane.doe@example.com",
                                },
                            ],
                        },
                    ],
                    metadata: {
                        customerId: "2345",
                    },
                },
            ],
            metadata: {
                customerId: "2345",
            },
        });
        expect(response).toEqual({
            merchantPlatformId: "12346",
            createdDate: "2024-07-02T12:00:00Z",
            lastModifiedDate: "2024-07-02T12:00:00Z",
            business: {
                name: "Example Corp",
                taxId: "xxxxx6789",
                organizationType: "privateCorporation",
                countryOfOperation: "US",
                addresses: [
                    {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                        type: "legalAddress",
                    },
                ],
                contactMethods: [
                    {
                        type: "email",
                        value: "jane.doe@example.com",
                    },
                    {
                        type: "phone",
                        value: "2025550164",
                    },
                ],
            },
            processingAccounts: [
                {
                    processingAccountId: "38765",
                    doingBusinessAs: "Pizza Doe",
                    status: "failed",
                    link: {
                        rel: "processingAccount",
                        href: "https://api.payroc.com/v1/processing-accounts/38765",
                        method: "get",
                    },
                    signature: {
                        type: "requestedViaDirectLink",
                        link: {
                            rel: "previous",
                            method: "get",
                            href: "<uri>",
                        },
                    },
                },
            ],
            metadata: {
                customerId: "2345",
            },
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "<uri>",
                },
            ],
        });
    });

    test("create (3)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            business: {
                name: "name",
                taxId: "taxId",
                organizationType: "privateCorporation",
                addresses: [
                    {
                        type: "legalAddress",
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    {
                        type: "legalAddress",
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                ],
                contactMethods: [
                    { type: "email", value: "value" },
                    { type: "email", value: "value" },
                ],
            },
            processingAccounts: [
                {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    processing: {
                        transactionAmounts: { average: 1, highest: 1 },
                        monthlyAmounts: { average: 1, highest: 1 },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
                    signature: { type: "requestedViaDirectLink" },
                },
                {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    processing: {
                        transactionAmounts: { average: 1, highest: 1 },
                        monthlyAmounts: { average: 1, highest: 1 },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
                    signature: { type: "requestedViaDirectLink" },
                },
            ],
        };
        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .post("/merchant-platforms")
            .header("Idempotency-Key", "idempotencyKey")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.create({
                "Idempotency-Key": "idempotencyKey",
                business: {
                    name: "name",
                    taxId: "taxId",
                    organizationType: "privateCorporation",
                    addresses: [
                        {
                            type: "legalAddress",
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        {
                            type: "legalAddress",
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                    ],
                    contactMethods: [
                        {
                            type: "email",
                            value: "value",
                        },
                        {
                            type: "email",
                            value: "value",
                        },
                    ],
                },
                processingAccounts: [
                    {
                        doingBusinessAs: "doingBusinessAs",
                        owners: [
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                        ],
                        businessType: "retail",
                        categoryCode: 1,
                        merchandiseOrServiceSold: "merchandiseOrServiceSold",
                        businessStartDate: "2023-01-15",
                        timezone: "Pacific/Midway",
                        address: {
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        contactMethods: [
                            {
                                type: "email",
                                value: "value",
                            },
                            {
                                type: "email",
                                value: "value",
                            },
                        ],
                        processing: {
                            transactionAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            monthlyAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            volumeBreakdown: {
                                cardPresentKeyed: 1,
                                cardPresentSwiped: 1,
                                mailOrTelephone: 1,
                                ecommerce: 1,
                            },
                        },
                        funding: {},
                        pricing: {
                            type: "intent",
                            pricingIntentId: "pricingIntentId",
                        },
                        signature: {
                            type: "requestedViaDirectLink",
                        },
                    },
                    {
                        doingBusinessAs: "doingBusinessAs",
                        owners: [
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                        ],
                        businessType: "retail",
                        categoryCode: 1,
                        merchandiseOrServiceSold: "merchandiseOrServiceSold",
                        businessStartDate: "2023-01-15",
                        timezone: "Pacific/Midway",
                        address: {
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        contactMethods: [
                            {
                                type: "email",
                                value: "value",
                            },
                            {
                                type: "email",
                                value: "value",
                            },
                        ],
                        processing: {
                            transactionAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            monthlyAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            volumeBreakdown: {
                                cardPresentKeyed: 1,
                                cardPresentSwiped: 1,
                                mailOrTelephone: 1,
                                ecommerce: 1,
                            },
                        },
                        funding: {},
                        pricing: {
                            type: "intent",
                            pricingIntentId: "pricingIntentId",
                        },
                        signature: {
                            type: "requestedViaDirectLink",
                        },
                    },
                ],
            });
        }).rejects.toThrow(Payroc.BadRequestError);
    });

    test("create (4)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            business: {
                name: "name",
                taxId: "taxId",
                organizationType: "privateCorporation",
                addresses: [
                    {
                        type: "legalAddress",
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    {
                        type: "legalAddress",
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                ],
                contactMethods: [
                    { type: "email", value: "value" },
                    { type: "email", value: "value" },
                ],
            },
            processingAccounts: [
                {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    processing: {
                        transactionAmounts: { average: 1, highest: 1 },
                        monthlyAmounts: { average: 1, highest: 1 },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
                    signature: { type: "requestedViaDirectLink" },
                },
                {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    processing: {
                        transactionAmounts: { average: 1, highest: 1 },
                        monthlyAmounts: { average: 1, highest: 1 },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
                    signature: { type: "requestedViaDirectLink" },
                },
            ],
        };
        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .post("/merchant-platforms")
            .header("Idempotency-Key", "idempotencyKey")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.create({
                "Idempotency-Key": "idempotencyKey",
                business: {
                    name: "name",
                    taxId: "taxId",
                    organizationType: "privateCorporation",
                    addresses: [
                        {
                            type: "legalAddress",
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        {
                            type: "legalAddress",
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                    ],
                    contactMethods: [
                        {
                            type: "email",
                            value: "value",
                        },
                        {
                            type: "email",
                            value: "value",
                        },
                    ],
                },
                processingAccounts: [
                    {
                        doingBusinessAs: "doingBusinessAs",
                        owners: [
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                        ],
                        businessType: "retail",
                        categoryCode: 1,
                        merchandiseOrServiceSold: "merchandiseOrServiceSold",
                        businessStartDate: "2023-01-15",
                        timezone: "Pacific/Midway",
                        address: {
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        contactMethods: [
                            {
                                type: "email",
                                value: "value",
                            },
                            {
                                type: "email",
                                value: "value",
                            },
                        ],
                        processing: {
                            transactionAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            monthlyAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            volumeBreakdown: {
                                cardPresentKeyed: 1,
                                cardPresentSwiped: 1,
                                mailOrTelephone: 1,
                                ecommerce: 1,
                            },
                        },
                        funding: {},
                        pricing: {
                            type: "intent",
                            pricingIntentId: "pricingIntentId",
                        },
                        signature: {
                            type: "requestedViaDirectLink",
                        },
                    },
                    {
                        doingBusinessAs: "doingBusinessAs",
                        owners: [
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                        ],
                        businessType: "retail",
                        categoryCode: 1,
                        merchandiseOrServiceSold: "merchandiseOrServiceSold",
                        businessStartDate: "2023-01-15",
                        timezone: "Pacific/Midway",
                        address: {
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        contactMethods: [
                            {
                                type: "email",
                                value: "value",
                            },
                            {
                                type: "email",
                                value: "value",
                            },
                        ],
                        processing: {
                            transactionAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            monthlyAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            volumeBreakdown: {
                                cardPresentKeyed: 1,
                                cardPresentSwiped: 1,
                                mailOrTelephone: 1,
                                ecommerce: 1,
                            },
                        },
                        funding: {},
                        pricing: {
                            type: "intent",
                            pricingIntentId: "pricingIntentId",
                        },
                        signature: {
                            type: "requestedViaDirectLink",
                        },
                    },
                ],
            });
        }).rejects.toThrow(Payroc.UnauthorizedError);
    });

    test("create (5)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            business: {
                name: "name",
                taxId: "taxId",
                organizationType: "privateCorporation",
                addresses: [
                    {
                        type: "legalAddress",
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    {
                        type: "legalAddress",
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                ],
                contactMethods: [
                    { type: "email", value: "value" },
                    { type: "email", value: "value" },
                ],
            },
            processingAccounts: [
                {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    processing: {
                        transactionAmounts: { average: 1, highest: 1 },
                        monthlyAmounts: { average: 1, highest: 1 },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
                    signature: { type: "requestedViaDirectLink" },
                },
                {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    processing: {
                        transactionAmounts: { average: 1, highest: 1 },
                        monthlyAmounts: { average: 1, highest: 1 },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
                    signature: { type: "requestedViaDirectLink" },
                },
            ],
        };
        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .post("/merchant-platforms")
            .header("Idempotency-Key", "idempotencyKey")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(403)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.create({
                "Idempotency-Key": "idempotencyKey",
                business: {
                    name: "name",
                    taxId: "taxId",
                    organizationType: "privateCorporation",
                    addresses: [
                        {
                            type: "legalAddress",
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        {
                            type: "legalAddress",
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                    ],
                    contactMethods: [
                        {
                            type: "email",
                            value: "value",
                        },
                        {
                            type: "email",
                            value: "value",
                        },
                    ],
                },
                processingAccounts: [
                    {
                        doingBusinessAs: "doingBusinessAs",
                        owners: [
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                        ],
                        businessType: "retail",
                        categoryCode: 1,
                        merchandiseOrServiceSold: "merchandiseOrServiceSold",
                        businessStartDate: "2023-01-15",
                        timezone: "Pacific/Midway",
                        address: {
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        contactMethods: [
                            {
                                type: "email",
                                value: "value",
                            },
                            {
                                type: "email",
                                value: "value",
                            },
                        ],
                        processing: {
                            transactionAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            monthlyAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            volumeBreakdown: {
                                cardPresentKeyed: 1,
                                cardPresentSwiped: 1,
                                mailOrTelephone: 1,
                                ecommerce: 1,
                            },
                        },
                        funding: {},
                        pricing: {
                            type: "intent",
                            pricingIntentId: "pricingIntentId",
                        },
                        signature: {
                            type: "requestedViaDirectLink",
                        },
                    },
                    {
                        doingBusinessAs: "doingBusinessAs",
                        owners: [
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                        ],
                        businessType: "retail",
                        categoryCode: 1,
                        merchandiseOrServiceSold: "merchandiseOrServiceSold",
                        businessStartDate: "2023-01-15",
                        timezone: "Pacific/Midway",
                        address: {
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        contactMethods: [
                            {
                                type: "email",
                                value: "value",
                            },
                            {
                                type: "email",
                                value: "value",
                            },
                        ],
                        processing: {
                            transactionAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            monthlyAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            volumeBreakdown: {
                                cardPresentKeyed: 1,
                                cardPresentSwiped: 1,
                                mailOrTelephone: 1,
                                ecommerce: 1,
                            },
                        },
                        funding: {},
                        pricing: {
                            type: "intent",
                            pricingIntentId: "pricingIntentId",
                        },
                        signature: {
                            type: "requestedViaDirectLink",
                        },
                    },
                ],
            });
        }).rejects.toThrow(Payroc.ForbiddenError);
    });

    test("create (6)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            business: {
                name: "name",
                taxId: "taxId",
                organizationType: "privateCorporation",
                addresses: [
                    {
                        type: "legalAddress",
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    {
                        type: "legalAddress",
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                ],
                contactMethods: [
                    { type: "email", value: "value" },
                    { type: "email", value: "value" },
                ],
            },
            processingAccounts: [
                {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    processing: {
                        transactionAmounts: { average: 1, highest: 1 },
                        monthlyAmounts: { average: 1, highest: 1 },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
                    signature: { type: "requestedViaDirectLink" },
                },
                {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    processing: {
                        transactionAmounts: { average: 1, highest: 1 },
                        monthlyAmounts: { average: 1, highest: 1 },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
                    signature: { type: "requestedViaDirectLink" },
                },
            ],
        };
        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .post("/merchant-platforms")
            .header("Idempotency-Key", "idempotencyKey")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(406)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.create({
                "Idempotency-Key": "idempotencyKey",
                business: {
                    name: "name",
                    taxId: "taxId",
                    organizationType: "privateCorporation",
                    addresses: [
                        {
                            type: "legalAddress",
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        {
                            type: "legalAddress",
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                    ],
                    contactMethods: [
                        {
                            type: "email",
                            value: "value",
                        },
                        {
                            type: "email",
                            value: "value",
                        },
                    ],
                },
                processingAccounts: [
                    {
                        doingBusinessAs: "doingBusinessAs",
                        owners: [
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                        ],
                        businessType: "retail",
                        categoryCode: 1,
                        merchandiseOrServiceSold: "merchandiseOrServiceSold",
                        businessStartDate: "2023-01-15",
                        timezone: "Pacific/Midway",
                        address: {
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        contactMethods: [
                            {
                                type: "email",
                                value: "value",
                            },
                            {
                                type: "email",
                                value: "value",
                            },
                        ],
                        processing: {
                            transactionAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            monthlyAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            volumeBreakdown: {
                                cardPresentKeyed: 1,
                                cardPresentSwiped: 1,
                                mailOrTelephone: 1,
                                ecommerce: 1,
                            },
                        },
                        funding: {},
                        pricing: {
                            type: "intent",
                            pricingIntentId: "pricingIntentId",
                        },
                        signature: {
                            type: "requestedViaDirectLink",
                        },
                    },
                    {
                        doingBusinessAs: "doingBusinessAs",
                        owners: [
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                        ],
                        businessType: "retail",
                        categoryCode: 1,
                        merchandiseOrServiceSold: "merchandiseOrServiceSold",
                        businessStartDate: "2023-01-15",
                        timezone: "Pacific/Midway",
                        address: {
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        contactMethods: [
                            {
                                type: "email",
                                value: "value",
                            },
                            {
                                type: "email",
                                value: "value",
                            },
                        ],
                        processing: {
                            transactionAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            monthlyAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            volumeBreakdown: {
                                cardPresentKeyed: 1,
                                cardPresentSwiped: 1,
                                mailOrTelephone: 1,
                                ecommerce: 1,
                            },
                        },
                        funding: {},
                        pricing: {
                            type: "intent",
                            pricingIntentId: "pricingIntentId",
                        },
                        signature: {
                            type: "requestedViaDirectLink",
                        },
                    },
                ],
            });
        }).rejects.toThrow(Payroc.NotAcceptableError);
    });

    test("create (7)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            business: {
                name: "name",
                taxId: "taxId",
                organizationType: "privateCorporation",
                addresses: [
                    {
                        type: "legalAddress",
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    {
                        type: "legalAddress",
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                ],
                contactMethods: [
                    { type: "email", value: "value" },
                    { type: "email", value: "value" },
                ],
            },
            processingAccounts: [
                {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    processing: {
                        transactionAmounts: { average: 1, highest: 1 },
                        monthlyAmounts: { average: 1, highest: 1 },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
                    signature: { type: "requestedViaDirectLink" },
                },
                {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    processing: {
                        transactionAmounts: { average: 1, highest: 1 },
                        monthlyAmounts: { average: 1, highest: 1 },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
                    signature: { type: "requestedViaDirectLink" },
                },
            ],
        };
        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .post("/merchant-platforms")
            .header("Idempotency-Key", "idempotencyKey")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(409)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.create({
                "Idempotency-Key": "idempotencyKey",
                business: {
                    name: "name",
                    taxId: "taxId",
                    organizationType: "privateCorporation",
                    addresses: [
                        {
                            type: "legalAddress",
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        {
                            type: "legalAddress",
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                    ],
                    contactMethods: [
                        {
                            type: "email",
                            value: "value",
                        },
                        {
                            type: "email",
                            value: "value",
                        },
                    ],
                },
                processingAccounts: [
                    {
                        doingBusinessAs: "doingBusinessAs",
                        owners: [
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                        ],
                        businessType: "retail",
                        categoryCode: 1,
                        merchandiseOrServiceSold: "merchandiseOrServiceSold",
                        businessStartDate: "2023-01-15",
                        timezone: "Pacific/Midway",
                        address: {
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        contactMethods: [
                            {
                                type: "email",
                                value: "value",
                            },
                            {
                                type: "email",
                                value: "value",
                            },
                        ],
                        processing: {
                            transactionAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            monthlyAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            volumeBreakdown: {
                                cardPresentKeyed: 1,
                                cardPresentSwiped: 1,
                                mailOrTelephone: 1,
                                ecommerce: 1,
                            },
                        },
                        funding: {},
                        pricing: {
                            type: "intent",
                            pricingIntentId: "pricingIntentId",
                        },
                        signature: {
                            type: "requestedViaDirectLink",
                        },
                    },
                    {
                        doingBusinessAs: "doingBusinessAs",
                        owners: [
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                        ],
                        businessType: "retail",
                        categoryCode: 1,
                        merchandiseOrServiceSold: "merchandiseOrServiceSold",
                        businessStartDate: "2023-01-15",
                        timezone: "Pacific/Midway",
                        address: {
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        contactMethods: [
                            {
                                type: "email",
                                value: "value",
                            },
                            {
                                type: "email",
                                value: "value",
                            },
                        ],
                        processing: {
                            transactionAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            monthlyAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            volumeBreakdown: {
                                cardPresentKeyed: 1,
                                cardPresentSwiped: 1,
                                mailOrTelephone: 1,
                                ecommerce: 1,
                            },
                        },
                        funding: {},
                        pricing: {
                            type: "intent",
                            pricingIntentId: "pricingIntentId",
                        },
                        signature: {
                            type: "requestedViaDirectLink",
                        },
                    },
                ],
            });
        }).rejects.toThrow(Payroc.ConflictError);
    });

    test("create (8)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            business: {
                name: "name",
                taxId: "taxId",
                organizationType: "privateCorporation",
                addresses: [
                    {
                        type: "legalAddress",
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    {
                        type: "legalAddress",
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                ],
                contactMethods: [
                    { type: "email", value: "value" },
                    { type: "email", value: "value" },
                ],
            },
            processingAccounts: [
                {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    processing: {
                        transactionAmounts: { average: 1, highest: 1 },
                        monthlyAmounts: { average: 1, highest: 1 },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
                    signature: { type: "requestedViaDirectLink" },
                },
                {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                { type: "nationalId", value: "value" },
                                { type: "nationalId", value: "value" },
                            ],
                            contactMethods: [
                                { type: "email", value: "value" },
                                { type: "email", value: "value" },
                            ],
                            relationship: { isControlProng: true },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    processing: {
                        transactionAmounts: { average: 1, highest: 1 },
                        monthlyAmounts: { average: 1, highest: 1 },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
                    signature: { type: "requestedViaDirectLink" },
                },
            ],
        };
        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .post("/merchant-platforms")
            .header("Idempotency-Key", "idempotencyKey")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.create({
                "Idempotency-Key": "idempotencyKey",
                business: {
                    name: "name",
                    taxId: "taxId",
                    organizationType: "privateCorporation",
                    addresses: [
                        {
                            type: "legalAddress",
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        {
                            type: "legalAddress",
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                    ],
                    contactMethods: [
                        {
                            type: "email",
                            value: "value",
                        },
                        {
                            type: "email",
                            value: "value",
                        },
                    ],
                },
                processingAccounts: [
                    {
                        doingBusinessAs: "doingBusinessAs",
                        owners: [
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                        ],
                        businessType: "retail",
                        categoryCode: 1,
                        merchandiseOrServiceSold: "merchandiseOrServiceSold",
                        businessStartDate: "2023-01-15",
                        timezone: "Pacific/Midway",
                        address: {
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        contactMethods: [
                            {
                                type: "email",
                                value: "value",
                            },
                            {
                                type: "email",
                                value: "value",
                            },
                        ],
                        processing: {
                            transactionAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            monthlyAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            volumeBreakdown: {
                                cardPresentKeyed: 1,
                                cardPresentSwiped: 1,
                                mailOrTelephone: 1,
                                ecommerce: 1,
                            },
                        },
                        funding: {},
                        pricing: {
                            type: "intent",
                            pricingIntentId: "pricingIntentId",
                        },
                        signature: {
                            type: "requestedViaDirectLink",
                        },
                    },
                    {
                        doingBusinessAs: "doingBusinessAs",
                        owners: [
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                            {
                                firstName: "firstName",
                                lastName: "lastName",
                                dateOfBirth: "2023-01-15",
                                address: {
                                    address1: "address1",
                                    city: "city",
                                    state: "state",
                                    country: "xy",
                                    postalCode: "postalCode",
                                },
                                identifiers: [
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                    {
                                        type: "nationalId",
                                        value: "value",
                                    },
                                ],
                                contactMethods: [
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                    {
                                        type: "email",
                                        value: "value",
                                    },
                                ],
                                relationship: {
                                    isControlProng: true,
                                },
                            },
                        ],
                        businessType: "retail",
                        categoryCode: 1,
                        merchandiseOrServiceSold: "merchandiseOrServiceSold",
                        businessStartDate: "2023-01-15",
                        timezone: "Pacific/Midway",
                        address: {
                            address1: "address1",
                            city: "city",
                            state: "state",
                            country: "xy",
                            postalCode: "postalCode",
                        },
                        contactMethods: [
                            {
                                type: "email",
                                value: "value",
                            },
                            {
                                type: "email",
                                value: "value",
                            },
                        ],
                        processing: {
                            transactionAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            monthlyAmounts: {
                                average: 1,
                                highest: 1,
                            },
                            volumeBreakdown: {
                                cardPresentKeyed: 1,
                                cardPresentSwiped: 1,
                                mailOrTelephone: 1,
                                ecommerce: 1,
                            },
                        },
                        funding: {},
                        pricing: {
                            type: "intent",
                            pricingIntentId: "pricingIntentId",
                        },
                        signature: {
                            type: "requestedViaDirectLink",
                        },
                    },
                ],
            });
        }).rejects.toThrow(Payroc.InternalServerError);
    });

    test("retrieve (1)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = {
            merchantPlatformId: "12345",
            createdDate: "2024-07-02T12:00:00Z",
            lastModifiedDate: "2024-07-02T12:00:00Z",
            business: {
                name: "Example Corp",
                taxId: "xxxxx6789",
                organizationType: "privateCorporation",
                countryOfOperation: "US",
                addresses: [
                    {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                        type: "legalAddress",
                    },
                ],
                contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
            },
            processingAccounts: [
                {
                    processingAccountId: "38765",
                    doingBusinessAs: "Pizza Doe",
                    status: "approved",
                    link: {
                        rel: "processingAccount",
                        href: "https://api.payroc.com/v1/processing-accounts/38765",
                        method: "get",
                    },
                    signature: {
                        type: "requestedViaDirectLink",
                        link: { rel: "previous", method: "get", href: "<uri>" },
                    },
                },
            ],
            metadata: { customerId: "2345" },
            links: [{ rel: "previous", method: "get", href: "<uri>" }],
        };
        server
            .mockEndpoint()
            .get("/merchant-platforms/12345")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.boarding.merchantPlatforms.retrieve({
            merchantPlatformId: "12345",
        });
        expect(response).toEqual({
            merchantPlatformId: "12345",
            createdDate: "2024-07-02T12:00:00Z",
            lastModifiedDate: "2024-07-02T12:00:00Z",
            business: {
                name: "Example Corp",
                taxId: "xxxxx6789",
                organizationType: "privateCorporation",
                countryOfOperation: "US",
                addresses: [
                    {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                        type: "legalAddress",
                    },
                ],
                contactMethods: [
                    {
                        type: "email",
                        value: "jane.doe@example.com",
                    },
                ],
            },
            processingAccounts: [
                {
                    processingAccountId: "38765",
                    doingBusinessAs: "Pizza Doe",
                    status: "approved",
                    link: {
                        rel: "processingAccount",
                        href: "https://api.payroc.com/v1/processing-accounts/38765",
                        method: "get",
                    },
                    signature: {
                        type: "requestedViaDirectLink",
                        link: {
                            rel: "previous",
                            method: "get",
                            href: "<uri>",
                        },
                    },
                },
            ],
            metadata: {
                customerId: "2345",
            },
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "<uri>",
                },
            ],
        });
    });

    test("retrieve (2)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .get("/merchant-platforms/merchantPlatformId")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.retrieve({
                merchantPlatformId: "merchantPlatformId",
            });
        }).rejects.toThrow(Payroc.BadRequestError);
    });

    test("retrieve (3)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .get("/merchant-platforms/merchantPlatformId")
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.retrieve({
                merchantPlatformId: "merchantPlatformId",
            });
        }).rejects.toThrow(Payroc.UnauthorizedError);
    });

    test("retrieve (4)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint()
            .get("/merchant-platforms/merchantPlatformId")
            .respondWith()
            .statusCode(403)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.retrieve({
                merchantPlatformId: "merchantPlatformId",
            });
        }).rejects.toThrow(Payroc.ForbiddenError);
    });

    test("retrieve (5)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .get("/merchant-platforms/merchantPlatformId")
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.retrieve({
                merchantPlatformId: "merchantPlatformId",
            });
        }).rejects.toThrow(Payroc.NotFoundError);
    });

    test("retrieve (6)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .get("/merchant-platforms/merchantPlatformId")
            .respondWith()
            .statusCode(406)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.retrieve({
                merchantPlatformId: "merchantPlatformId",
            });
        }).rejects.toThrow(Payroc.NotAcceptableError);
    });

    test("retrieve (7)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .get("/merchant-platforms/merchantPlatformId")
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.retrieve({
                merchantPlatformId: "merchantPlatformId",
            });
        }).rejects.toThrow(Payroc.InternalServerError);
    });

    test("listProcessingAccounts (1)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = {
            limit: 2,
            count: 2,
            hasMore: true,
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "https://api.payroc.com/v1/merchant-platforms/12345/processing-accounts?before=38765&limit=2",
                },
                {
                    rel: "next",
                    method: "get",
                    href: "https://api.payroc.com/v1/merchant-platforms/12345/processing-accounts?after=38766&limit=2",
                },
            ],
            data: [
                {
                    processingAccountId: "38765",
                    createdDate: "2024-07-02T12:00:00Z",
                    lastModifiedDate: "2024-07-02T12:00:00Z",
                    status: "approved",
                    doingBusinessAs: "Pizza Doe",
                    owners: [
                        {
                            ownerId: 4564,
                            firstName: "Jane",
                            lastName: "Doe",
                            link: { rel: "owner", href: "https://api.payroc.com/v1/owners/4564", method: "get" },
                        },
                    ],
                    website: "www.example.com",
                    businessType: "restaurant",
                    categoryCode: 5999,
                    merchandiseOrServiceSold: "Food",
                    businessStartDate: "2020-01-01",
                    timezone: "America/Chicago",
                    address: {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                    },
                    contactMethods: [
                        { type: "email", value: "jane.doe@example.com" },
                        { type: "phone", value: "2025550164" },
                    ],
                    processing: {
                        merchantId: "444412365478965",
                        transactionAmounts: { average: 1000, highest: 200000 },
                        monthlyAmounts: { average: 1000000, highest: 200000000 },
                        volumeBreakdown: {
                            cardPresentKeyed: 47,
                            cardPresentSwiped: 30,
                            mailOrTelephone: 3,
                            ecommerce: 20,
                        },
                        isSeasonal: true,
                        monthsOfOperation: ["jan", "feb", "mar", "nov", "dec"],
                        ach: {
                            naics: "5812",
                            previouslyTerminatedForAch: false,
                            refunds: { writtenRefundPolicy: true, refundPolicyUrl: "http://www.example.com/refunds" },
                            estimatedMonthlyTransactions: 1000,
                            limits: { singleTransaction: 10000000, dailyDeposit: 1000, monthlyDeposit: 2000 },
                            transactionTypes: ["telephoneInitiatedPayment", "webInitiatedPayment"],
                            transactionTypesOther: "anotherTransactionType",
                        },
                        cardAcceptance: {
                            debitOnly: false,
                            hsaFsa: false,
                            cardsAccepted: ["visa", "mastercard"],
                            specialityCards: {
                                americanExpressDirect: { enabled: true, merchantNumber: "1234567890" },
                                electronicBenefitsTransfer: { enabled: true, fnsNumber: "1234567" },
                                other: {
                                    wexMerchantNumber: "1234567890",
                                    voyagerMerchantId: "1234567890",
                                    fleetMerchantId: "1234567890",
                                },
                            },
                        },
                    },
                    funding: {
                        status: "enabled",
                        fundingSchedule: "nextday",
                        acceleratedFundingFee: 1999,
                        dailyDiscount: false,
                        fundingAccounts: [
                            {
                                fundingAccountId: 123,
                                status: "pending",
                                link: {
                                    rel: "fundingAccount",
                                    method: "get",
                                    href: "https://api.payroc.com/v1/funding-accounts/123",
                                },
                            },
                        ],
                    },
                    pricing: {
                        link: {
                            rel: "pricing",
                            href: "https://api.payroc.com/v1/processing-accounts/12345/pricing",
                            method: "get",
                        },
                    },
                    contacts: [
                        {
                            contactId: 1543,
                            firstName: "Jane",
                            lastName: "Doe",
                            link: { rel: "owner", href: "https://api.payroc.com/v1/contacts/1543", method: "get" },
                        },
                    ],
                    signature: { type: "requestedViaEmail" },
                    metadata: { customerId: "2345" },
                    links: [{ rel: "previous", method: "get", href: "<uri>" }],
                },
                {
                    processingAccountId: "38766",
                    createdDate: "2024-07-02T12:00:00Z",
                    lastModifiedDate: "2024-07-02T12:00:00Z",
                    status: "approved",
                    doingBusinessAs: "Doe Hot Dogs",
                    owners: [
                        {
                            ownerId: 4564,
                            firstName: "Jane",
                            lastName: "Doe",
                            link: { rel: "owner", href: "https://api.payroc.com/v1/owners/4564", method: "get" },
                        },
                    ],
                    website: "www.example.com",
                    businessType: "internet",
                    categoryCode: 5999,
                    merchandiseOrServiceSold: "Food",
                    businessStartDate: "2020-01-01",
                    timezone: "America/Chicago",
                    address: {
                        address1: "3 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                    },
                    contactMethods: [
                        { type: "email", value: "jane.doe@example.com" },
                        { type: "phone", value: "2025550164" },
                    ],
                    processing: {
                        merchantId: "444412365478966",
                        transactionAmounts: { average: 2000, highest: 300000 },
                        monthlyAmounts: { average: 2000000, highest: 300000000 },
                        volumeBreakdown: {
                            cardPresentKeyed: 0,
                            cardPresentSwiped: 0,
                            mailOrTelephone: 0,
                            ecommerce: 100,
                        },
                        isSeasonal: true,
                        monthsOfOperation: ["jan", "feb"],
                        ach: {
                            naics: "5812",
                            previouslyTerminatedForAch: false,
                            refunds: {
                                writtenRefundPolicy: true,
                                refundPolicyUrl: "www.example.com/refund-poilcy-url",
                            },
                            estimatedMonthlyTransactions: 3000,
                            limits: { singleTransaction: 10000, dailyDeposit: 200000, monthlyDeposit: 6000000 },
                            transactionTypes: ["prearrangedPayment", "other"],
                            transactionTypesOther: "anotherTransactionType",
                        },
                    },
                    funding: {
                        status: "enabled",
                        fundingSchedule: "nextday",
                        acceleratedFundingFee: 1999,
                        dailyDiscount: false,
                        fundingAccounts: [
                            {
                                fundingAccountId: 124,
                                status: "pending",
                                link: {
                                    rel: "fundingAccount",
                                    method: "get",
                                    href: "https://api.payroc.com/v1/funding-accounts/124",
                                },
                            },
                        ],
                    },
                    pricing: {
                        link: {
                            rel: "pricing",
                            href: "https://api.payroc.com/v1/processing-accounts/12346/pricing",
                            method: "get",
                        },
                    },
                    contacts: [
                        {
                            contactId: 1543,
                            firstName: "Jane",
                            lastName: "Doe",
                            link: { rel: "owner", href: "https://api.payroc.com/v1/contacts/1543", method: "get" },
                        },
                    ],
                    signature: { type: "requestedViaEmail" },
                    metadata: { customerId: "2345" },
                    links: [{ rel: "previous", method: "get", href: "<uri>" }],
                },
            ],
        };
        server
            .mockEndpoint({ once: false })
            .get("/merchant-platforms/12345/processing-accounts")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const expected = {
            limit: 2,
            count: 2,
            hasMore: true,
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "https://api.payroc.com/v1/merchant-platforms/12345/processing-accounts?before=38765&limit=2",
                },
                {
                    rel: "next",
                    method: "get",
                    href: "https://api.payroc.com/v1/merchant-platforms/12345/processing-accounts?after=38766&limit=2",
                },
            ],
            data: [
                {
                    processingAccountId: "38765",
                    createdDate: "2024-07-02T12:00:00Z",
                    lastModifiedDate: "2024-07-02T12:00:00Z",
                    status: "approved",
                    doingBusinessAs: "Pizza Doe",
                    owners: [
                        {
                            ownerId: 4564,
                            firstName: "Jane",
                            lastName: "Doe",
                            link: {
                                rel: "owner",
                                href: "https://api.payroc.com/v1/owners/4564",
                                method: "get",
                            },
                        },
                    ],
                    website: "www.example.com",
                    businessType: "restaurant",
                    categoryCode: 5999,
                    merchandiseOrServiceSold: "Food",
                    businessStartDate: "2020-01-01",
                    timezone: "America/Chicago",
                    address: {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                    },
                    contactMethods: [
                        {
                            type: "email",
                            value: "jane.doe@example.com",
                        },
                        {
                            type: "phone",
                            value: "2025550164",
                        },
                    ],
                    processing: {
                        merchantId: "444412365478965",
                        transactionAmounts: {
                            average: 1000,
                            highest: 200000,
                        },
                        monthlyAmounts: {
                            average: 1000000,
                            highest: 200000000,
                        },
                        volumeBreakdown: {
                            cardPresentKeyed: 47,
                            cardPresentSwiped: 30,
                            mailOrTelephone: 3,
                            ecommerce: 20,
                        },
                        isSeasonal: true,
                        monthsOfOperation: ["jan", "feb", "mar", "nov", "dec"],
                        ach: {
                            naics: "5812",
                            previouslyTerminatedForAch: false,
                            refunds: {
                                writtenRefundPolicy: true,
                                refundPolicyUrl: "http://www.example.com/refunds",
                            },
                            estimatedMonthlyTransactions: 1000,
                            limits: {
                                singleTransaction: 10000000,
                                dailyDeposit: 1000,
                                monthlyDeposit: 2000,
                            },
                            transactionTypes: ["telephoneInitiatedPayment", "webInitiatedPayment"],
                            transactionTypesOther: "anotherTransactionType",
                        },
                        cardAcceptance: {
                            debitOnly: false,
                            hsaFsa: false,
                            cardsAccepted: ["visa", "mastercard"],
                            specialityCards: {
                                americanExpressDirect: {
                                    enabled: true,
                                    merchantNumber: "1234567890",
                                },
                                electronicBenefitsTransfer: {
                                    enabled: true,
                                    fnsNumber: "1234567",
                                },
                                other: {
                                    wexMerchantNumber: "1234567890",
                                    voyagerMerchantId: "1234567890",
                                    fleetMerchantId: "1234567890",
                                },
                            },
                        },
                    },
                    funding: {
                        status: "enabled",
                        fundingSchedule: "nextday",
                        acceleratedFundingFee: 1999,
                        dailyDiscount: false,
                        fundingAccounts: [
                            {
                                fundingAccountId: 123,
                                status: "pending",
                                link: {
                                    rel: "fundingAccount",
                                    method: "get",
                                    href: "https://api.payroc.com/v1/funding-accounts/123",
                                },
                            },
                        ],
                    },
                    pricing: {
                        link: {
                            rel: "pricing",
                            href: "https://api.payroc.com/v1/processing-accounts/12345/pricing",
                            method: "get",
                        },
                    },
                    contacts: [
                        {
                            contactId: 1543,
                            firstName: "Jane",
                            lastName: "Doe",
                            link: {
                                rel: "owner",
                                href: "https://api.payroc.com/v1/contacts/1543",
                                method: "get",
                            },
                        },
                    ],
                    signature: {
                        type: "requestedViaEmail",
                    },
                    metadata: {
                        customerId: "2345",
                    },
                    links: [
                        {
                            rel: "previous",
                            method: "get",
                            href: "<uri>",
                        },
                    ],
                },
                {
                    processingAccountId: "38766",
                    createdDate: "2024-07-02T12:00:00Z",
                    lastModifiedDate: "2024-07-02T12:00:00Z",
                    status: "approved",
                    doingBusinessAs: "Doe Hot Dogs",
                    owners: [
                        {
                            ownerId: 4564,
                            firstName: "Jane",
                            lastName: "Doe",
                            link: {
                                rel: "owner",
                                href: "https://api.payroc.com/v1/owners/4564",
                                method: "get",
                            },
                        },
                    ],
                    website: "www.example.com",
                    businessType: "internet",
                    categoryCode: 5999,
                    merchandiseOrServiceSold: "Food",
                    businessStartDate: "2020-01-01",
                    timezone: "America/Chicago",
                    address: {
                        address1: "3 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                    },
                    contactMethods: [
                        {
                            type: "email",
                            value: "jane.doe@example.com",
                        },
                        {
                            type: "phone",
                            value: "2025550164",
                        },
                    ],
                    processing: {
                        merchantId: "444412365478966",
                        transactionAmounts: {
                            average: 2000,
                            highest: 300000,
                        },
                        monthlyAmounts: {
                            average: 2000000,
                            highest: 300000000,
                        },
                        volumeBreakdown: {
                            cardPresentKeyed: 0,
                            cardPresentSwiped: 0,
                            mailOrTelephone: 0,
                            ecommerce: 100,
                        },
                        isSeasonal: true,
                        monthsOfOperation: ["jan", "feb"],
                        ach: {
                            naics: "5812",
                            previouslyTerminatedForAch: false,
                            refunds: {
                                writtenRefundPolicy: true,
                                refundPolicyUrl: "www.example.com/refund-poilcy-url",
                            },
                            estimatedMonthlyTransactions: 3000,
                            limits: {
                                singleTransaction: 10000,
                                dailyDeposit: 200000,
                                monthlyDeposit: 6000000,
                            },
                            transactionTypes: ["prearrangedPayment", "other"],
                            transactionTypesOther: "anotherTransactionType",
                        },
                    },
                    funding: {
                        status: "enabled",
                        fundingSchedule: "nextday",
                        acceleratedFundingFee: 1999,
                        dailyDiscount: false,
                        fundingAccounts: [
                            {
                                fundingAccountId: 124,
                                status: "pending",
                                link: {
                                    rel: "fundingAccount",
                                    method: "get",
                                    href: "https://api.payroc.com/v1/funding-accounts/124",
                                },
                            },
                        ],
                    },
                    pricing: {
                        link: {
                            rel: "pricing",
                            href: "https://api.payroc.com/v1/processing-accounts/12346/pricing",
                            method: "get",
                        },
                    },
                    contacts: [
                        {
                            contactId: 1543,
                            firstName: "Jane",
                            lastName: "Doe",
                            link: {
                                rel: "owner",
                                href: "https://api.payroc.com/v1/contacts/1543",
                                method: "get",
                            },
                        },
                    ],
                    signature: {
                        type: "requestedViaEmail",
                    },
                    metadata: {
                        customerId: "2345",
                    },
                    links: [
                        {
                            rel: "previous",
                            method: "get",
                            href: "<uri>",
                        },
                    ],
                },
            ],
        };
        const page = await client.boarding.merchantPlatforms.listProcessingAccounts({
            merchantPlatformId: "12345",
            before: "2571",
            after: "8516",
            limit: 1,
            includeClosed: true,
        });
        expect(expected.data).toEqual(page.data);
    });

    test("listProcessingAccounts (2)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = {
            limit: 10,
            count: 0,
            hasMore: false,
            links: [
                { rel: "previous", method: "get", href: "<uri>" },
                { rel: "next", method: "get", href: "<uri>" },
            ],
            data: [
                {
                    processingAccountId: "38765",
                    createdDate: "2024-07-02T12:00:00Z",
                    lastModifiedDate: "2024-07-02T12:00:00Z",
                    status: "entered",
                    doingBusinessAs: "Pizza Doe",
                    owners: [{ ownerId: 4564, firstName: "Jane", lastName: "Doe" }],
                    website: "www.example.com",
                    businessType: "retail",
                    categoryCode: 5999,
                    merchandiseOrServiceSold: "Pizza",
                    businessStartDate: "2020-01-01",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                    },
                    contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
                    processing: {
                        merchantId: "4525644354",
                        transactionAmounts: { average: 5000, highest: 10000 },
                        monthlyAmounts: { average: 50000, highest: 100000 },
                        volumeBreakdown: {
                            cardPresentKeyed: 47,
                            cardPresentSwiped: 30,
                            mailOrTelephone: 3,
                            ecommerce: 20,
                        },
                        isSeasonal: false,
                        monthsOfOperation: ["jan", "feb"],
                        ach: {
                            naics: "5812",
                            previouslyTerminatedForAch: false,
                            refunds: {
                                writtenRefundPolicy: true,
                                refundPolicyUrl: "www.example.com/refund-poilcy-url",
                            },
                            estimatedMonthlyTransactions: 3000,
                            limits: { singleTransaction: 10000, dailyDeposit: 200000, monthlyDeposit: 6000000 },
                            transactionTypes: ["prearrangedPayment", "other"],
                            transactionTypesOther: "anotherTransactionType",
                        },
                    },
                    funding: { acceleratedFundingFee: 1999, dailyDiscount: false },
                    pricing: {},
                    contacts: [{ contactId: 1543, firstName: "Jane", lastName: "Doe" }],
                    signature: {
                        type: "requestedViaDirectLink",
                        link: { rel: "previous", method: "get", href: "<uri>" },
                    },
                    metadata: { customerId: "2345" },
                    links: [{ rel: "previous", method: "get", href: "<uri>" }],
                },
            ],
        };
        server
            .mockEndpoint({ once: false })
            .get("/merchant-platforms/12345/processing-accounts")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const expected = {
            limit: 10,
            count: 0,
            hasMore: false,
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "<uri>",
                },
                {
                    rel: "next",
                    method: "get",
                    href: "<uri>",
                },
            ],
            data: [
                {
                    processingAccountId: "38765",
                    createdDate: "2024-07-02T12:00:00Z",
                    lastModifiedDate: "2024-07-02T12:00:00Z",
                    status: "entered",
                    doingBusinessAs: "Pizza Doe",
                    owners: [
                        {
                            ownerId: 4564,
                            firstName: "Jane",
                            lastName: "Doe",
                        },
                    ],
                    website: "www.example.com",
                    businessType: "retail",
                    categoryCode: 5999,
                    merchandiseOrServiceSold: "Pizza",
                    businessStartDate: "2020-01-01",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                    },
                    contactMethods: [
                        {
                            type: "email",
                            value: "jane.doe@example.com",
                        },
                    ],
                    processing: {
                        merchantId: "4525644354",
                        transactionAmounts: {
                            average: 5000,
                            highest: 10000,
                        },
                        monthlyAmounts: {
                            average: 50000,
                            highest: 100000,
                        },
                        volumeBreakdown: {
                            cardPresentKeyed: 47,
                            cardPresentSwiped: 30,
                            mailOrTelephone: 3,
                            ecommerce: 20,
                        },
                        isSeasonal: false,
                        monthsOfOperation: ["jan", "feb"],
                        ach: {
                            naics: "5812",
                            previouslyTerminatedForAch: false,
                            refunds: {
                                writtenRefundPolicy: true,
                                refundPolicyUrl: "www.example.com/refund-poilcy-url",
                            },
                            estimatedMonthlyTransactions: 3000,
                            limits: {
                                singleTransaction: 10000,
                                dailyDeposit: 200000,
                                monthlyDeposit: 6000000,
                            },
                            transactionTypes: ["prearrangedPayment", "other"],
                            transactionTypesOther: "anotherTransactionType",
                        },
                    },
                    funding: {
                        acceleratedFundingFee: 1999,
                        dailyDiscount: false,
                    },
                    pricing: {},
                    contacts: [
                        {
                            contactId: 1543,
                            firstName: "Jane",
                            lastName: "Doe",
                        },
                    ],
                    signature: {
                        type: "requestedViaDirectLink",
                        link: {
                            rel: "previous",
                            method: "get",
                            href: "<uri>",
                        },
                    },
                    metadata: {
                        customerId: "2345",
                    },
                    links: [
                        {
                            rel: "previous",
                            method: "get",
                            href: "<uri>",
                        },
                    ],
                },
            ],
        };
        const page = await client.boarding.merchantPlatforms.listProcessingAccounts({
            merchantPlatformId: "12345",
            before: "2571",
            after: "8516",
            limit: 1,
            includeClosed: true,
        });
        expect(expected.data).toEqual(page.data);
    });

    test("listProcessingAccounts (3)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint({ once: false })
            .get("/merchant-platforms/merchantPlatformId/processing-accounts")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.listProcessingAccounts({
                merchantPlatformId: "merchantPlatformId",
            });
        }).rejects.toThrow(Payroc.BadRequestError);
    });

    test("listProcessingAccounts (4)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint({ once: false })
            .get("/merchant-platforms/merchantPlatformId/processing-accounts")
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.listProcessingAccounts({
                merchantPlatformId: "merchantPlatformId",
            });
        }).rejects.toThrow(Payroc.UnauthorizedError);
    });

    test("listProcessingAccounts (5)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint({ once: false })
            .get("/merchant-platforms/merchantPlatformId/processing-accounts")
            .respondWith()
            .statusCode(403)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.listProcessingAccounts({
                merchantPlatformId: "merchantPlatformId",
            });
        }).rejects.toThrow(Payroc.ForbiddenError);
    });

    test("listProcessingAccounts (6)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint({ once: false })
            .get("/merchant-platforms/merchantPlatformId/processing-accounts")
            .respondWith()
            .statusCode(406)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.listProcessingAccounts({
                merchantPlatformId: "merchantPlatformId",
            });
        }).rejects.toThrow(Payroc.NotAcceptableError);
    });

    test("listProcessingAccounts (7)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint({ once: false })
            .get("/merchant-platforms/merchantPlatformId/processing-accounts")
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.listProcessingAccounts({
                merchantPlatformId: "merchantPlatformId",
            });
        }).rejects.toThrow(Payroc.InternalServerError);
    });

    test("createProcessingAccount (1)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            doingBusinessAs: "Pizza Doe",
            owners: [
                {
                    firstName: "Jane",
                    middleName: "Helen",
                    lastName: "Doe",
                    dateOfBirth: "1964-03-22",
                    address: {
                        address1: "1 Example Ave.",
                        address2: "Example Address Line 2",
                        address3: "Example Address Line 3",
                        city: "Chicago",
                        state: "Illinois",
                        country: "US",
                        postalCode: "60056",
                    },
                    identifiers: [{ type: "nationalId", value: "000-00-4320" }],
                    contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
                    relationship: {
                        equityPercentage: 51.5,
                        title: "CFO",
                        isControlProng: true,
                        isAuthorizedSignatory: false,
                    },
                },
            ],
            website: "www.example.com",
            businessType: "restaurant",
            categoryCode: 5999,
            merchandiseOrServiceSold: "Pizza",
            businessStartDate: "2020-01-01",
            timezone: "America/Chicago",
            address: {
                address1: "1 Example Ave.",
                address2: "Example Address Line 2",
                address3: "Example Address Line 3",
                city: "Chicago",
                state: "Illinois",
                country: "US",
                postalCode: "60056",
            },
            contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
            processing: {
                transactionAmounts: { average: 5000, highest: 10000 },
                monthlyAmounts: { average: 50000, highest: 100000 },
                volumeBreakdown: { cardPresentKeyed: 47, cardPresentSwiped: 30, mailOrTelephone: 3, ecommerce: 20 },
                isSeasonal: true,
                monthsOfOperation: ["jan", "feb"],
                ach: {
                    naics: "5812",
                    previouslyTerminatedForAch: false,
                    refunds: { writtenRefundPolicy: true, refundPolicyUrl: "www.example.com/refund-poilcy-url" },
                    estimatedMonthlyTransactions: 3000,
                    limits: { singleTransaction: 10000, dailyDeposit: 200000, monthlyDeposit: 6000000 },
                    transactionTypes: ["prearrangedPayment", "other"],
                    transactionTypesOther: "anotherTransactionType",
                },
                cardAcceptance: {
                    debitOnly: false,
                    hsaFsa: false,
                    cardsAccepted: ["visa", "mastercard"],
                    specialityCards: {
                        americanExpressDirect: { enabled: true, merchantNumber: "abc1234567" },
                        electronicBenefitsTransfer: { enabled: true, fnsNumber: "6789012" },
                        other: {
                            wexMerchantNumber: "abc1234567",
                            voyagerMerchantId: "abc1234567",
                            fleetMerchantId: "abc1234567",
                        },
                    },
                },
            },
            funding: {
                fundingSchedule: "nextday",
                acceleratedFundingFee: 1999,
                dailyDiscount: false,
                fundingAccounts: [
                    {
                        type: "checking",
                        use: "creditAndDebit",
                        nameOnAccount: "Jane Doe",
                        paymentMethods: [{ type: "ach" }],
                        metadata: { yourCustomField: "abc123" },
                    },
                ],
            },
            pricing: { type: "intent", pricingIntentId: "6123" },
            signature: { type: "requestedViaDirectLink" },
            contacts: [
                {
                    type: "manager",
                    firstName: "Jane",
                    middleName: "Helen",
                    lastName: "Doe",
                    identifiers: [{ type: "nationalId", value: "000-00-4320" }],
                    contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
                },
            ],
            metadata: { customerId: "2345" },
        };
        const rawResponseBody = {
            processingAccountId: "38765",
            createdDate: "2024-07-02T12:00:00Z",
            lastModifiedDate: "2024-07-02T12:00:00Z",
            status: "entered",
            doingBusinessAs: "Pizza Doe",
            owners: [
                {
                    ownerId: 4564,
                    firstName: "Jane",
                    lastName: "Doe",
                    link: { rel: "owner", href: "https://api.payroc.com/v1/owners/4564", method: "get" },
                },
            ],
            website: "www.example.com",
            businessType: "restaurant",
            categoryCode: 5999,
            merchandiseOrServiceSold: "Pizza",
            businessStartDate: "2020-01-01",
            timezone: "America/Chicago",
            address: {
                address1: "1 Example Ave.",
                address2: "Example Address Line 2",
                address3: "Example Address Line 3",
                city: "Chicago",
                state: "Illinois",
                country: "US",
                postalCode: "60056",
            },
            contactMethods: [{ type: "email", value: "jane.doe@example.com" }],
            processing: {
                merchantId: "4525644354",
                transactionAmounts: { average: 5000, highest: 10000 },
                monthlyAmounts: { average: 50000, highest: 100000 },
                volumeBreakdown: { cardPresentKeyed: 47, cardPresentSwiped: 30, mailOrTelephone: 3, ecommerce: 20 },
                isSeasonal: true,
                monthsOfOperation: ["jan", "feb"],
                ach: {
                    naics: "5812",
                    previouslyTerminatedForAch: false,
                    refunds: { writtenRefundPolicy: true, refundPolicyUrl: "www.example.com/refund-poilcy-url" },
                    estimatedMonthlyTransactions: 3000,
                    limits: { singleTransaction: 10000, dailyDeposit: 200000, monthlyDeposit: 6000000 },
                    transactionTypes: ["prearrangedPayment", "other"],
                    transactionTypesOther: "anotherTransactionType",
                },
                cardAcceptance: {
                    debitOnly: false,
                    hsaFsa: false,
                    cardsAccepted: ["visa", "mastercard"],
                    specialityCards: {
                        americanExpressDirect: { enabled: true, merchantNumber: "abc1234567" },
                        electronicBenefitsTransfer: { enabled: true, fnsNumber: "6789012" },
                        other: {
                            wexMerchantNumber: "abc1234567",
                            voyagerMerchantId: "abc1234567",
                            fleetMerchantId: "abc1234567",
                        },
                    },
                },
            },
            funding: {
                status: "enabled",
                fundingSchedule: "nextday",
                acceleratedFundingFee: 1999,
                dailyDiscount: false,
                fundingAccounts: [
                    {
                        fundingAccountId: 123,
                        status: "pending",
                        link: {
                            rel: "fundingAccount",
                            method: "get",
                            href: "https://api.payroc.com/v1/funding-accounts/123",
                        },
                    },
                ],
            },
            pricing: {
                link: {
                    rel: "pricing",
                    href: "https://api.payroc.com/v1/processing-accounts/12345/pricing",
                    method: "get",
                },
            },
            contacts: [
                {
                    contactId: 1543,
                    firstName: "Jane",
                    lastName: "Doe",
                    link: { rel: "contact", href: "https://api.payroc.com/v1/contacts/1543", method: "get" },
                },
            ],
            signature: { type: "requestedViaDirectLink", link: { rel: "previous", method: "get", href: "<uri>" } },
            metadata: { customerId: "2345" },
            links: [{ rel: "previous", method: "get", href: "<uri>" }],
        };
        server
            .mockEndpoint()
            .post("/merchant-platforms/12345/processing-accounts")
            .header("Idempotency-Key", "8e03978e-40d5-43e8-bc93-6894a57f9324")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const response = await client.boarding.merchantPlatforms.createProcessingAccount({
            "Idempotency-Key": "8e03978e-40d5-43e8-bc93-6894a57f9324",
            merchantPlatformId: "12345",
            body: {
                doingBusinessAs: "Pizza Doe",
                owners: [
                    {
                        firstName: "Jane",
                        middleName: "Helen",
                        lastName: "Doe",
                        dateOfBirth: "1964-03-22",
                        address: {
                            address1: "1 Example Ave.",
                            address2: "Example Address Line 2",
                            address3: "Example Address Line 3",
                            city: "Chicago",
                            state: "Illinois",
                            country: "US",
                            postalCode: "60056",
                        },
                        identifiers: [
                            {
                                type: "nationalId",
                                value: "000-00-4320",
                            },
                        ],
                        contactMethods: [
                            {
                                type: "email",
                                value: "jane.doe@example.com",
                            },
                        ],
                        relationship: {
                            equityPercentage: 51.5,
                            title: "CFO",
                            isControlProng: true,
                            isAuthorizedSignatory: false,
                        },
                    },
                ],
                website: "www.example.com",
                businessType: "restaurant",
                categoryCode: 5999,
                merchandiseOrServiceSold: "Pizza",
                businessStartDate: "2020-01-01",
                timezone: "America/Chicago",
                address: {
                    address1: "1 Example Ave.",
                    address2: "Example Address Line 2",
                    address3: "Example Address Line 3",
                    city: "Chicago",
                    state: "Illinois",
                    country: "US",
                    postalCode: "60056",
                },
                contactMethods: [
                    {
                        type: "email",
                        value: "jane.doe@example.com",
                    },
                ],
                processing: {
                    transactionAmounts: {
                        average: 5000,
                        highest: 10000,
                    },
                    monthlyAmounts: {
                        average: 50000,
                        highest: 100000,
                    },
                    volumeBreakdown: {
                        cardPresentKeyed: 47,
                        cardPresentSwiped: 30,
                        mailOrTelephone: 3,
                        ecommerce: 20,
                    },
                    isSeasonal: true,
                    monthsOfOperation: ["jan", "feb"],
                    ach: {
                        naics: "5812",
                        previouslyTerminatedForAch: false,
                        refunds: {
                            writtenRefundPolicy: true,
                            refundPolicyUrl: "www.example.com/refund-poilcy-url",
                        },
                        estimatedMonthlyTransactions: 3000,
                        limits: {
                            singleTransaction: 10000,
                            dailyDeposit: 200000,
                            monthlyDeposit: 6000000,
                        },
                        transactionTypes: ["prearrangedPayment", "other"],
                        transactionTypesOther: "anotherTransactionType",
                    },
                    cardAcceptance: {
                        debitOnly: false,
                        hsaFsa: false,
                        cardsAccepted: ["visa", "mastercard"],
                        specialityCards: {
                            americanExpressDirect: {
                                enabled: true,
                                merchantNumber: "abc1234567",
                            },
                            electronicBenefitsTransfer: {
                                enabled: true,
                                fnsNumber: "6789012",
                            },
                            other: {
                                wexMerchantNumber: "abc1234567",
                                voyagerMerchantId: "abc1234567",
                                fleetMerchantId: "abc1234567",
                            },
                        },
                    },
                },
                funding: {
                    fundingSchedule: "nextday",
                    acceleratedFundingFee: 1999,
                    dailyDiscount: false,
                    fundingAccounts: [
                        {
                            type: "checking",
                            use: "creditAndDebit",
                            nameOnAccount: "Jane Doe",
                            paymentMethods: [
                                {
                                    type: "ach",
                                },
                            ],
                            metadata: {
                                yourCustomField: "abc123",
                            },
                        },
                    ],
                },
                pricing: {
                    type: "intent",
                    pricingIntentId: "6123",
                },
                signature: {
                    type: "requestedViaDirectLink",
                },
                contacts: [
                    {
                        type: "manager",
                        firstName: "Jane",
                        middleName: "Helen",
                        lastName: "Doe",
                        identifiers: [
                            {
                                type: "nationalId",
                                value: "000-00-4320",
                            },
                        ],
                        contactMethods: [
                            {
                                type: "email",
                                value: "jane.doe@example.com",
                            },
                        ],
                    },
                ],
                metadata: {
                    customerId: "2345",
                },
            },
        });
        expect(response).toEqual({
            processingAccountId: "38765",
            createdDate: "2024-07-02T12:00:00Z",
            lastModifiedDate: "2024-07-02T12:00:00Z",
            status: "entered",
            doingBusinessAs: "Pizza Doe",
            owners: [
                {
                    ownerId: 4564,
                    firstName: "Jane",
                    lastName: "Doe",
                    link: {
                        rel: "owner",
                        href: "https://api.payroc.com/v1/owners/4564",
                        method: "get",
                    },
                },
            ],
            website: "www.example.com",
            businessType: "restaurant",
            categoryCode: 5999,
            merchandiseOrServiceSold: "Pizza",
            businessStartDate: "2020-01-01",
            timezone: "America/Chicago",
            address: {
                address1: "1 Example Ave.",
                address2: "Example Address Line 2",
                address3: "Example Address Line 3",
                city: "Chicago",
                state: "Illinois",
                country: "US",
                postalCode: "60056",
            },
            contactMethods: [
                {
                    type: "email",
                    value: "jane.doe@example.com",
                },
            ],
            processing: {
                merchantId: "4525644354",
                transactionAmounts: {
                    average: 5000,
                    highest: 10000,
                },
                monthlyAmounts: {
                    average: 50000,
                    highest: 100000,
                },
                volumeBreakdown: {
                    cardPresentKeyed: 47,
                    cardPresentSwiped: 30,
                    mailOrTelephone: 3,
                    ecommerce: 20,
                },
                isSeasonal: true,
                monthsOfOperation: ["jan", "feb"],
                ach: {
                    naics: "5812",
                    previouslyTerminatedForAch: false,
                    refunds: {
                        writtenRefundPolicy: true,
                        refundPolicyUrl: "www.example.com/refund-poilcy-url",
                    },
                    estimatedMonthlyTransactions: 3000,
                    limits: {
                        singleTransaction: 10000,
                        dailyDeposit: 200000,
                        monthlyDeposit: 6000000,
                    },
                    transactionTypes: ["prearrangedPayment", "other"],
                    transactionTypesOther: "anotherTransactionType",
                },
                cardAcceptance: {
                    debitOnly: false,
                    hsaFsa: false,
                    cardsAccepted: ["visa", "mastercard"],
                    specialityCards: {
                        americanExpressDirect: {
                            enabled: true,
                            merchantNumber: "abc1234567",
                        },
                        electronicBenefitsTransfer: {
                            enabled: true,
                            fnsNumber: "6789012",
                        },
                        other: {
                            wexMerchantNumber: "abc1234567",
                            voyagerMerchantId: "abc1234567",
                            fleetMerchantId: "abc1234567",
                        },
                    },
                },
            },
            funding: {
                status: "enabled",
                fundingSchedule: "nextday",
                acceleratedFundingFee: 1999,
                dailyDiscount: false,
                fundingAccounts: [
                    {
                        fundingAccountId: 123,
                        status: "pending",
                        link: {
                            rel: "fundingAccount",
                            method: "get",
                            href: "https://api.payroc.com/v1/funding-accounts/123",
                        },
                    },
                ],
            },
            pricing: {
                link: {
                    rel: "pricing",
                    href: "https://api.payroc.com/v1/processing-accounts/12345/pricing",
                    method: "get",
                },
            },
            contacts: [
                {
                    contactId: 1543,
                    firstName: "Jane",
                    lastName: "Doe",
                    link: {
                        rel: "contact",
                        href: "https://api.payroc.com/v1/contacts/1543",
                        method: "get",
                    },
                },
            ],
            signature: {
                type: "requestedViaDirectLink",
                link: {
                    rel: "previous",
                    method: "get",
                    href: "<uri>",
                },
            },
            metadata: {
                customerId: "2345",
            },
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "<uri>",
                },
            ],
        });
    });

    test("createProcessingAccount (2)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            doingBusinessAs: "doingBusinessAs",
            owners: [
                {
                    firstName: "firstName",
                    lastName: "lastName",
                    dateOfBirth: "2023-01-15",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    identifiers: [
                        { type: "nationalId", value: "value" },
                        { type: "nationalId", value: "value" },
                    ],
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    relationship: { isControlProng: true },
                },
                {
                    firstName: "firstName",
                    lastName: "lastName",
                    dateOfBirth: "2023-01-15",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    identifiers: [
                        { type: "nationalId", value: "value" },
                        { type: "nationalId", value: "value" },
                    ],
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    relationship: { isControlProng: true },
                },
            ],
            businessType: "retail",
            categoryCode: 1,
            merchandiseOrServiceSold: "merchandiseOrServiceSold",
            businessStartDate: "2023-01-15",
            timezone: "Pacific/Midway",
            address: { address1: "address1", city: "city", state: "state", country: "xy", postalCode: "postalCode" },
            contactMethods: [
                { type: "email", value: "value" },
                { type: "email", value: "value" },
            ],
            processing: {
                transactionAmounts: { average: 1, highest: 1 },
                monthlyAmounts: { average: 1, highest: 1 },
                volumeBreakdown: { cardPresentKeyed: 1, cardPresentSwiped: 1, mailOrTelephone: 1, ecommerce: 1 },
            },
            funding: {},
            pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
            signature: { type: "requestedViaDirectLink" },
        };
        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .post("/merchant-platforms/merchantPlatformId/processing-accounts")
            .header("Idempotency-Key", "idempotencyKey")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.createProcessingAccount({
                "Idempotency-Key": "idempotencyKey",
                merchantPlatformId: "merchantPlatformId",
                body: {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "value",
                                },
                                {
                                    type: "email",
                                    value: "value",
                                },
                            ],
                            relationship: {
                                isControlProng: true,
                            },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "value",
                                },
                                {
                                    type: "email",
                                    value: "value",
                                },
                            ],
                            relationship: {
                                isControlProng: true,
                            },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        {
                            type: "email",
                            value: "value",
                        },
                        {
                            type: "email",
                            value: "value",
                        },
                    ],
                    processing: {
                        transactionAmounts: {
                            average: 1,
                            highest: 1,
                        },
                        monthlyAmounts: {
                            average: 1,
                            highest: 1,
                        },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: {
                        type: "intent",
                        pricingIntentId: "pricingIntentId",
                    },
                    signature: {
                        type: "requestedViaDirectLink",
                    },
                },
            });
        }).rejects.toThrow(Payroc.BadRequestError);
    });

    test("createProcessingAccount (3)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            doingBusinessAs: "doingBusinessAs",
            owners: [
                {
                    firstName: "firstName",
                    lastName: "lastName",
                    dateOfBirth: "2023-01-15",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    identifiers: [
                        { type: "nationalId", value: "value" },
                        { type: "nationalId", value: "value" },
                    ],
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    relationship: { isControlProng: true },
                },
                {
                    firstName: "firstName",
                    lastName: "lastName",
                    dateOfBirth: "2023-01-15",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    identifiers: [
                        { type: "nationalId", value: "value" },
                        { type: "nationalId", value: "value" },
                    ],
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    relationship: { isControlProng: true },
                },
            ],
            businessType: "retail",
            categoryCode: 1,
            merchandiseOrServiceSold: "merchandiseOrServiceSold",
            businessStartDate: "2023-01-15",
            timezone: "Pacific/Midway",
            address: { address1: "address1", city: "city", state: "state", country: "xy", postalCode: "postalCode" },
            contactMethods: [
                { type: "email", value: "value" },
                { type: "email", value: "value" },
            ],
            processing: {
                transactionAmounts: { average: 1, highest: 1 },
                monthlyAmounts: { average: 1, highest: 1 },
                volumeBreakdown: { cardPresentKeyed: 1, cardPresentSwiped: 1, mailOrTelephone: 1, ecommerce: 1 },
            },
            funding: {},
            pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
            signature: { type: "requestedViaDirectLink" },
        };
        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .post("/merchant-platforms/merchantPlatformId/processing-accounts")
            .header("Idempotency-Key", "idempotencyKey")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.createProcessingAccount({
                "Idempotency-Key": "idempotencyKey",
                merchantPlatformId: "merchantPlatformId",
                body: {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "value",
                                },
                                {
                                    type: "email",
                                    value: "value",
                                },
                            ],
                            relationship: {
                                isControlProng: true,
                            },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "value",
                                },
                                {
                                    type: "email",
                                    value: "value",
                                },
                            ],
                            relationship: {
                                isControlProng: true,
                            },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        {
                            type: "email",
                            value: "value",
                        },
                        {
                            type: "email",
                            value: "value",
                        },
                    ],
                    processing: {
                        transactionAmounts: {
                            average: 1,
                            highest: 1,
                        },
                        monthlyAmounts: {
                            average: 1,
                            highest: 1,
                        },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: {
                        type: "intent",
                        pricingIntentId: "pricingIntentId",
                    },
                    signature: {
                        type: "requestedViaDirectLink",
                    },
                },
            });
        }).rejects.toThrow(Payroc.UnauthorizedError);
    });

    test("createProcessingAccount (4)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            doingBusinessAs: "doingBusinessAs",
            owners: [
                {
                    firstName: "firstName",
                    lastName: "lastName",
                    dateOfBirth: "2023-01-15",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    identifiers: [
                        { type: "nationalId", value: "value" },
                        { type: "nationalId", value: "value" },
                    ],
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    relationship: { isControlProng: true },
                },
                {
                    firstName: "firstName",
                    lastName: "lastName",
                    dateOfBirth: "2023-01-15",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    identifiers: [
                        { type: "nationalId", value: "value" },
                        { type: "nationalId", value: "value" },
                    ],
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    relationship: { isControlProng: true },
                },
            ],
            businessType: "retail",
            categoryCode: 1,
            merchandiseOrServiceSold: "merchandiseOrServiceSold",
            businessStartDate: "2023-01-15",
            timezone: "Pacific/Midway",
            address: { address1: "address1", city: "city", state: "state", country: "xy", postalCode: "postalCode" },
            contactMethods: [
                { type: "email", value: "value" },
                { type: "email", value: "value" },
            ],
            processing: {
                transactionAmounts: { average: 1, highest: 1 },
                monthlyAmounts: { average: 1, highest: 1 },
                volumeBreakdown: { cardPresentKeyed: 1, cardPresentSwiped: 1, mailOrTelephone: 1, ecommerce: 1 },
            },
            funding: {},
            pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
            signature: { type: "requestedViaDirectLink" },
        };
        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .post("/merchant-platforms/merchantPlatformId/processing-accounts")
            .header("Idempotency-Key", "idempotencyKey")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(404)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.createProcessingAccount({
                "Idempotency-Key": "idempotencyKey",
                merchantPlatformId: "merchantPlatformId",
                body: {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "value",
                                },
                                {
                                    type: "email",
                                    value: "value",
                                },
                            ],
                            relationship: {
                                isControlProng: true,
                            },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "value",
                                },
                                {
                                    type: "email",
                                    value: "value",
                                },
                            ],
                            relationship: {
                                isControlProng: true,
                            },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        {
                            type: "email",
                            value: "value",
                        },
                        {
                            type: "email",
                            value: "value",
                        },
                    ],
                    processing: {
                        transactionAmounts: {
                            average: 1,
                            highest: 1,
                        },
                        monthlyAmounts: {
                            average: 1,
                            highest: 1,
                        },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: {
                        type: "intent",
                        pricingIntentId: "pricingIntentId",
                    },
                    signature: {
                        type: "requestedViaDirectLink",
                    },
                },
            });
        }).rejects.toThrow(Payroc.NotFoundError);
    });

    test("createProcessingAccount (5)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            doingBusinessAs: "doingBusinessAs",
            owners: [
                {
                    firstName: "firstName",
                    lastName: "lastName",
                    dateOfBirth: "2023-01-15",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    identifiers: [
                        { type: "nationalId", value: "value" },
                        { type: "nationalId", value: "value" },
                    ],
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    relationship: { isControlProng: true },
                },
                {
                    firstName: "firstName",
                    lastName: "lastName",
                    dateOfBirth: "2023-01-15",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    identifiers: [
                        { type: "nationalId", value: "value" },
                        { type: "nationalId", value: "value" },
                    ],
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    relationship: { isControlProng: true },
                },
            ],
            businessType: "retail",
            categoryCode: 1,
            merchandiseOrServiceSold: "merchandiseOrServiceSold",
            businessStartDate: "2023-01-15",
            timezone: "Pacific/Midway",
            address: { address1: "address1", city: "city", state: "state", country: "xy", postalCode: "postalCode" },
            contactMethods: [
                { type: "email", value: "value" },
                { type: "email", value: "value" },
            ],
            processing: {
                transactionAmounts: { average: 1, highest: 1 },
                monthlyAmounts: { average: 1, highest: 1 },
                volumeBreakdown: { cardPresentKeyed: 1, cardPresentSwiped: 1, mailOrTelephone: 1, ecommerce: 1 },
            },
            funding: {},
            pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
            signature: { type: "requestedViaDirectLink" },
        };
        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .post("/merchant-platforms/merchantPlatformId/processing-accounts")
            .header("Idempotency-Key", "idempotencyKey")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(406)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.createProcessingAccount({
                "Idempotency-Key": "idempotencyKey",
                merchantPlatformId: "merchantPlatformId",
                body: {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "value",
                                },
                                {
                                    type: "email",
                                    value: "value",
                                },
                            ],
                            relationship: {
                                isControlProng: true,
                            },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "value",
                                },
                                {
                                    type: "email",
                                    value: "value",
                                },
                            ],
                            relationship: {
                                isControlProng: true,
                            },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        {
                            type: "email",
                            value: "value",
                        },
                        {
                            type: "email",
                            value: "value",
                        },
                    ],
                    processing: {
                        transactionAmounts: {
                            average: 1,
                            highest: 1,
                        },
                        monthlyAmounts: {
                            average: 1,
                            highest: 1,
                        },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: {
                        type: "intent",
                        pricingIntentId: "pricingIntentId",
                    },
                    signature: {
                        type: "requestedViaDirectLink",
                    },
                },
            });
        }).rejects.toThrow(Payroc.NotAcceptableError);
    });

    test("createProcessingAccount (6)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            doingBusinessAs: "doingBusinessAs",
            owners: [
                {
                    firstName: "firstName",
                    lastName: "lastName",
                    dateOfBirth: "2023-01-15",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    identifiers: [
                        { type: "nationalId", value: "value" },
                        { type: "nationalId", value: "value" },
                    ],
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    relationship: { isControlProng: true },
                },
                {
                    firstName: "firstName",
                    lastName: "lastName",
                    dateOfBirth: "2023-01-15",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    identifiers: [
                        { type: "nationalId", value: "value" },
                        { type: "nationalId", value: "value" },
                    ],
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    relationship: { isControlProng: true },
                },
            ],
            businessType: "retail",
            categoryCode: 1,
            merchandiseOrServiceSold: "merchandiseOrServiceSold",
            businessStartDate: "2023-01-15",
            timezone: "Pacific/Midway",
            address: { address1: "address1", city: "city", state: "state", country: "xy", postalCode: "postalCode" },
            contactMethods: [
                { type: "email", value: "value" },
                { type: "email", value: "value" },
            ],
            processing: {
                transactionAmounts: { average: 1, highest: 1 },
                monthlyAmounts: { average: 1, highest: 1 },
                volumeBreakdown: { cardPresentKeyed: 1, cardPresentSwiped: 1, mailOrTelephone: 1, ecommerce: 1 },
            },
            funding: {},
            pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
            signature: { type: "requestedViaDirectLink" },
        };
        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .post("/merchant-platforms/merchantPlatformId/processing-accounts")
            .header("Idempotency-Key", "idempotencyKey")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(409)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.createProcessingAccount({
                "Idempotency-Key": "idempotencyKey",
                merchantPlatformId: "merchantPlatformId",
                body: {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "value",
                                },
                                {
                                    type: "email",
                                    value: "value",
                                },
                            ],
                            relationship: {
                                isControlProng: true,
                            },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "value",
                                },
                                {
                                    type: "email",
                                    value: "value",
                                },
                            ],
                            relationship: {
                                isControlProng: true,
                            },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        {
                            type: "email",
                            value: "value",
                        },
                        {
                            type: "email",
                            value: "value",
                        },
                    ],
                    processing: {
                        transactionAmounts: {
                            average: 1,
                            highest: 1,
                        },
                        monthlyAmounts: {
                            average: 1,
                            highest: 1,
                        },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: {
                        type: "intent",
                        pricingIntentId: "pricingIntentId",
                    },
                    signature: {
                        type: "requestedViaDirectLink",
                    },
                },
            });
        }).rejects.toThrow(Payroc.ConflictError);
    });

    test("createProcessingAccount (7)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });
        const rawRequestBody = {
            doingBusinessAs: "doingBusinessAs",
            owners: [
                {
                    firstName: "firstName",
                    lastName: "lastName",
                    dateOfBirth: "2023-01-15",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    identifiers: [
                        { type: "nationalId", value: "value" },
                        { type: "nationalId", value: "value" },
                    ],
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    relationship: { isControlProng: true },
                },
                {
                    firstName: "firstName",
                    lastName: "lastName",
                    dateOfBirth: "2023-01-15",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    identifiers: [
                        { type: "nationalId", value: "value" },
                        { type: "nationalId", value: "value" },
                    ],
                    contactMethods: [
                        { type: "email", value: "value" },
                        { type: "email", value: "value" },
                    ],
                    relationship: { isControlProng: true },
                },
            ],
            businessType: "retail",
            categoryCode: 1,
            merchandiseOrServiceSold: "merchandiseOrServiceSold",
            businessStartDate: "2023-01-15",
            timezone: "Pacific/Midway",
            address: { address1: "address1", city: "city", state: "state", country: "xy", postalCode: "postalCode" },
            contactMethods: [
                { type: "email", value: "value" },
                { type: "email", value: "value" },
            ],
            processing: {
                transactionAmounts: { average: 1, highest: 1 },
                monthlyAmounts: { average: 1, highest: 1 },
                volumeBreakdown: { cardPresentKeyed: 1, cardPresentSwiped: 1, mailOrTelephone: 1, ecommerce: 1 },
            },
            funding: {},
            pricing: { type: "intent", pricingIntentId: "pricingIntentId" },
            signature: { type: "requestedViaDirectLink" },
        };
        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint()
            .post("/merchant-platforms/merchantPlatformId/processing-accounts")
            .header("Idempotency-Key", "idempotencyKey")
            .jsonBody(rawRequestBody)
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.boarding.merchantPlatforms.createProcessingAccount({
                "Idempotency-Key": "idempotencyKey",
                merchantPlatformId: "merchantPlatformId",
                body: {
                    doingBusinessAs: "doingBusinessAs",
                    owners: [
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "value",
                                },
                                {
                                    type: "email",
                                    value: "value",
                                },
                            ],
                            relationship: {
                                isControlProng: true,
                            },
                        },
                        {
                            firstName: "firstName",
                            lastName: "lastName",
                            dateOfBirth: "2023-01-15",
                            address: {
                                address1: "address1",
                                city: "city",
                                state: "state",
                                country: "xy",
                                postalCode: "postalCode",
                            },
                            identifiers: [
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                                {
                                    type: "nationalId",
                                    value: "value",
                                },
                            ],
                            contactMethods: [
                                {
                                    type: "email",
                                    value: "value",
                                },
                                {
                                    type: "email",
                                    value: "value",
                                },
                            ],
                            relationship: {
                                isControlProng: true,
                            },
                        },
                    ],
                    businessType: "retail",
                    categoryCode: 1,
                    merchandiseOrServiceSold: "merchandiseOrServiceSold",
                    businessStartDate: "2023-01-15",
                    timezone: "Pacific/Midway",
                    address: {
                        address1: "address1",
                        city: "city",
                        state: "state",
                        country: "xy",
                        postalCode: "postalCode",
                    },
                    contactMethods: [
                        {
                            type: "email",
                            value: "value",
                        },
                        {
                            type: "email",
                            value: "value",
                        },
                    ],
                    processing: {
                        transactionAmounts: {
                            average: 1,
                            highest: 1,
                        },
                        monthlyAmounts: {
                            average: 1,
                            highest: 1,
                        },
                        volumeBreakdown: {
                            cardPresentKeyed: 1,
                            cardPresentSwiped: 1,
                            mailOrTelephone: 1,
                            ecommerce: 1,
                        },
                    },
                    funding: {},
                    pricing: {
                        type: "intent",
                        pricingIntentId: "pricingIntentId",
                    },
                    signature: {
                        type: "requestedViaDirectLink",
                    },
                },
            });
        }).rejects.toThrow(Payroc.InternalServerError);
    });
});
