// This file was auto-generated by Fern from our API Definition.

import * as Payroc from "../../../src/api/index";
import { PayrocClient } from "../../../src/Client";
import { mockServerPool } from "../../mock-server/MockServerPool";
import { mockBearer } from "../mockAuth";

describe("FundingActivityClient", () => {
    test("retrieveBalance (1)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = {
            limit: 2,
            count: 2,
            hasMore: true,
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "https://api.payroc.com/v1/funding-balance?before=4525644354&limit=2",
                },
                {
                    rel: "next",
                    method: "get",
                    href: "https://api.payroc.com/v1/funding-balance?after=9876543219&limit=2",
                },
            ],
            data: [
                { merchantId: "4525644354", funds: 120000, pending: 50050, available: 69950, currency: "USD" },
                { merchantId: "9876543219", funds: 50000, pending: 0, available: 50000, currency: "USD" },
            ],
        };
        server.mockEndpoint().get("/funding-balance").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.funding.fundingActivity.retrieveBalance({
            before: "2571",
            after: "8516",
            limit: 1,
            merchantId: "4525644354",
        });
        expect(response).toEqual({
            limit: 2,
            count: 2,
            hasMore: true,
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "https://api.payroc.com/v1/funding-balance?before=4525644354&limit=2",
                },
                {
                    rel: "next",
                    method: "get",
                    href: "https://api.payroc.com/v1/funding-balance?after=9876543219&limit=2",
                },
            ],
            data: [
                {
                    merchantId: "4525644354",
                    funds: 120000,
                    pending: 50050,
                    available: 69950,
                    currency: "USD",
                },
                {
                    merchantId: "9876543219",
                    funds: 50000,
                    pending: 0,
                    available: 50000,
                    currency: "USD",
                },
            ],
        });
    });

    test("retrieveBalance (2)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = {
            limit: 10,
            count: 0,
            hasMore: false,
            links: [
                { rel: "previous", method: "get", href: "<uri>" },
                { rel: "next", method: "get", href: "<uri>" },
            ],
            data: [{ merchantId: "4525644354", funds: 120000, pending: 50050, available: 69950, currency: "USD" }],
        };
        server.mockEndpoint().get("/funding-balance").respondWith().statusCode(200).jsonBody(rawResponseBody).build();

        const response = await client.funding.fundingActivity.retrieveBalance({
            before: "2571",
            after: "8516",
            limit: 1,
            merchantId: "4525644354",
        });
        expect(response).toEqual({
            limit: 10,
            count: 0,
            hasMore: false,
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "<uri>",
                },
                {
                    rel: "next",
                    method: "get",
                    href: "<uri>",
                },
            ],
            data: [
                {
                    merchantId: "4525644354",
                    funds: 120000,
                    pending: 50050,
                    available: 69950,
                    currency: "USD",
                },
            ],
        });
    });

    test("retrieveBalance (3)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server.mockEndpoint().get("/funding-balance").respondWith().statusCode(400).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.funding.fundingActivity.retrieveBalance();
        }).rejects.toThrow(Payroc.BadRequestError);
    });

    test("retrieveBalance (4)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server.mockEndpoint().get("/funding-balance").respondWith().statusCode(401).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.funding.fundingActivity.retrieveBalance();
        }).rejects.toThrow(Payroc.UnauthorizedError);
    });

    test("retrieveBalance (5)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { key: "value" };
        server.mockEndpoint().get("/funding-balance").respondWith().statusCode(403).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.funding.fundingActivity.retrieveBalance();
        }).rejects.toThrow(Payroc.ForbiddenError);
    });

    test("retrieveBalance (6)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server.mockEndpoint().get("/funding-balance").respondWith().statusCode(406).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.funding.fundingActivity.retrieveBalance();
        }).rejects.toThrow(Payroc.NotAcceptableError);
    });

    test("retrieveBalance (7)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server.mockEndpoint().get("/funding-balance").respondWith().statusCode(500).jsonBody(rawResponseBody).build();

        await expect(async () => {
            return await client.funding.fundingActivity.retrieveBalance();
        }).rejects.toThrow(Payroc.InternalServerError);
    });

    test("list (1)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = {
            limit: 10,
            count: 10,
            hasMore: true,
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "https://api.payroc.com/v1/funding-activity?before=11&limit=10&datefrom=2024-07-01&dateto=2024-07-03",
                },
                {
                    rel: "next",
                    method: "get",
                    href: "https://api.payroc.com/v1/funding-activity?after=20&limit=10&datefrom=2024-07-01&dateto=2024-07-03",
                },
            ],
            data: [
                {
                    id: 11,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Pizza Doe",
                    description: "sales",
                    amount: 4999,
                    type: "credit",
                    currency: "USD",
                },
                {
                    id: 12,
                    date: "2024-07-02T19:32:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Pizza Doe",
                    description: "sales",
                    amount: 3999,
                    type: "credit",
                    currency: "USD",
                },
                {
                    id: 13,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Pizza Doe",
                    description: "sales",
                    amount: 3299,
                    type: "credit",
                    currency: "USD",
                },
                {
                    id: 14,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Payroc",
                    description: "Interchange Fees",
                    amount: 50,
                    type: "debit",
                    currency: "USD",
                },
                {
                    id: 15,
                    date: "2024-07-02T09:10:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Pizza Doe",
                    description: "sales",
                    amount: 4999,
                    type: "credit",
                    currency: "USD",
                },
                {
                    id: 16,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Doe Hot Dogs",
                    recipient: "Pizza Doe",
                    description: "Adjustment",
                    amount: 750,
                    type: "credit",
                    currency: "USD",
                },
                {
                    id: 17,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Doe Hot Dogs",
                    recipient: "Payroc",
                    description: "Interchange Fees",
                    amount: 5,
                    type: "debit",
                    currency: "USD",
                },
                {
                    id: 18,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Payroc",
                    description: "Charge back",
                    amount: 1000,
                    type: "debit",
                    currency: "USD",
                },
                {
                    id: 19,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Pizza Doe",
                    description: "sales",
                    amount: 5999,
                    type: "credit",
                    currency: "USD",
                },
                {
                    id: 20,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Pizza Doe",
                    description: "payment",
                    amount: 1000,
                    type: "debit",
                    currency: "USD",
                },
            ],
        };
        server
            .mockEndpoint({ once: false })
            .get("/funding-activity")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const expected = {
            limit: 10,
            count: 10,
            hasMore: true,
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "https://api.payroc.com/v1/funding-activity?before=11&limit=10&datefrom=2024-07-01&dateto=2024-07-03",
                },
                {
                    rel: "next",
                    method: "get",
                    href: "https://api.payroc.com/v1/funding-activity?after=20&limit=10&datefrom=2024-07-01&dateto=2024-07-03",
                },
            ],
            data: [
                {
                    id: 11,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Pizza Doe",
                    description: "sales",
                    amount: 4999,
                    type: "credit",
                    currency: "USD",
                },
                {
                    id: 12,
                    date: "2024-07-02T19:32:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Pizza Doe",
                    description: "sales",
                    amount: 3999,
                    type: "credit",
                    currency: "USD",
                },
                {
                    id: 13,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Pizza Doe",
                    description: "sales",
                    amount: 3299,
                    type: "credit",
                    currency: "USD",
                },
                {
                    id: 14,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Payroc",
                    description: "Interchange Fees",
                    amount: 50,
                    type: "debit",
                    currency: "USD",
                },
                {
                    id: 15,
                    date: "2024-07-02T09:10:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Pizza Doe",
                    description: "sales",
                    amount: 4999,
                    type: "credit",
                    currency: "USD",
                },
                {
                    id: 16,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Doe Hot Dogs",
                    recipient: "Pizza Doe",
                    description: "Adjustment",
                    amount: 750,
                    type: "credit",
                    currency: "USD",
                },
                {
                    id: 17,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Doe Hot Dogs",
                    recipient: "Payroc",
                    description: "Interchange Fees",
                    amount: 5,
                    type: "debit",
                    currency: "USD",
                },
                {
                    id: 18,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Payroc",
                    description: "Charge back",
                    amount: 1000,
                    type: "debit",
                    currency: "USD",
                },
                {
                    id: 19,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Pizza Doe",
                    description: "sales",
                    amount: 5999,
                    type: "credit",
                    currency: "USD",
                },
                {
                    id: 20,
                    date: "2024-07-02T17:00:00.000Z",
                    merchant: "Pizza Doe",
                    recipient: "Pizza Doe",
                    description: "payment",
                    amount: 1000,
                    type: "debit",
                    currency: "USD",
                },
            ],
        };
        const page = await client.funding.fundingActivity.list({
            before: "2571",
            after: "8516",
            limit: 1,
            dateFrom: "2024-07-02",
            dateTo: "2024-07-03",
            merchantId: "4525644354",
        });
        expect(expected.data).toEqual(page.data);
    });

    test("list (2)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = {
            limit: 10,
            count: 0,
            hasMore: false,
            links: [
                { rel: "previous", method: "get", href: "<uri>" },
                { rel: "next", method: "get", href: "<uri>" },
            ],
            data: [
                {
                    id: 12345,
                    date: "2024-07-02T15:30:00Z",
                    merchant: "Pizza Doe",
                    recipient: "Pizza Doe",
                    description: "payment",
                    amount: 4999,
                    type: "credit",
                    currency: "USD",
                },
            ],
        };
        server
            .mockEndpoint({ once: false })
            .get("/funding-activity")
            .respondWith()
            .statusCode(200)
            .jsonBody(rawResponseBody)
            .build();

        const expected = {
            limit: 10,
            count: 0,
            hasMore: false,
            links: [
                {
                    rel: "previous",
                    method: "get",
                    href: "<uri>",
                },
                {
                    rel: "next",
                    method: "get",
                    href: "<uri>",
                },
            ],
            data: [
                {
                    id: 12345,
                    date: "2024-07-02T15:30:00Z",
                    merchant: "Pizza Doe",
                    recipient: "Pizza Doe",
                    description: "payment",
                    amount: 4999,
                    type: "credit",
                    currency: "USD",
                },
            ],
        };
        const page = await client.funding.fundingActivity.list({
            before: "2571",
            after: "8516",
            limit: 1,
            dateFrom: "2024-07-02",
            dateTo: "2024-07-03",
            merchantId: "4525644354",
        });
        expect(expected.data).toEqual(page.data);
    });

    test("list (3)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint({ once: false })
            .get("/funding-activity")
            .respondWith()
            .statusCode(400)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.funding.fundingActivity.list({
                dateFrom: "2023-01-15",
                dateTo: "2023-01-15",
            });
        }).rejects.toThrow(Payroc.BadRequestError);
    });

    test("list (4)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint({ once: false })
            .get("/funding-activity")
            .respondWith()
            .statusCode(401)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.funding.fundingActivity.list({
                dateFrom: "2023-01-15",
                dateTo: "2023-01-15",
            });
        }).rejects.toThrow(Payroc.UnauthorizedError);
    });

    test("list (5)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { key: "value" };
        server
            .mockEndpoint({ once: false })
            .get("/funding-activity")
            .respondWith()
            .statusCode(403)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.funding.fundingActivity.list({
                dateFrom: "2023-01-15",
                dateTo: "2023-01-15",
            });
        }).rejects.toThrow(Payroc.ForbiddenError);
    });

    test("list (6)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint({ once: false })
            .get("/funding-activity")
            .respondWith()
            .statusCode(406)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.funding.fundingActivity.list({
                dateFrom: "2023-01-15",
                dateTo: "2023-01-15",
            });
        }).rejects.toThrow(Payroc.NotAcceptableError);
    });

    test("list (7)", async () => {
        const server = mockServerPool.createServer();
        mockBearer(server);

        const client = new PayrocClient({
            maxRetries: 0,
            apiKey: "x-api-key",
            environment: { api: server.baseUrl, identity: server.baseUrl },
        });

        const rawResponseBody = { type: "type", title: "title", status: 1, detail: "detail" };
        server
            .mockEndpoint({ once: false })
            .get("/funding-activity")
            .respondWith()
            .statusCode(500)
            .jsonBody(rawResponseBody)
            .build();

        await expect(async () => {
            return await client.funding.fundingActivity.list({
                dateFrom: "2023-01-15",
                dateTo: "2023-01-15",
            });
        }).rejects.toThrow(Payroc.InternalServerError);
    });
});
